<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemistry Mastery - Group 1 Alkali Metals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Sheets API -->
    <script src="https://apis.google.com/js/api.js"></script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S76E52MQ37"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-S76E52MQ37');
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Text Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 5px rgba(79, 70, 229, 0.7); }
            50% { text-shadow: 0 0 20px rgba(79, 70, 229, 0.9), 0 0 30px rgba(79, 70, 229, 0.7); }
        }
        
        @keyframes typewriter {
            from { width: 0; }
            to { width: 100%; }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes highlight {
            0% { background-color: rgba(79, 70, 229, 0.2); }
            50% { background-color: rgba(79, 70, 229, 0.4); }
            100% { background-color: rgba(79, 70, 229, 0.2); }
        }
        
        @keyframes textReveal {
            0% { 
                opacity: 0;
                transform: translateY(30px) scale(0.9);
                filter: blur(10px);
            }
            100% { 
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0);
            }
        }
        
        @keyframes slideUp {
            0% { 
                opacity: 0;
                transform: translateY(50px);
            }
            100% { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes letterPop {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        @keyframes colorShift {
            0% { color: #4f46e5; }
            25% { color: #7c3aed; }
            50% { color: #ec4899; }
            75% { color: #8b5cf6; }
            100% { color: #4f46e5; }
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        @keyframes valenceElectronGlow {
            0%, 100% { 
                color: #4f46e5;
                text-shadow: 0 0 5px rgba(79, 70, 229, 0.7);
            }
            50% { 
                color: #f59e0b;
                text-shadow: 0 0 15px rgba(245, 158, 11, 0.9);
                transform: scale(1.2);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .glow-text {
            animation: glow 2s infinite;
            font-weight: 700;
            color: #4f46e5;
        }
        
        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            animation: typewriter 3s steps(40) 1s 1 normal both;
        }
        
        .bounce-text {
            display: inline-block;
            animation: bounce 1s ease infinite;
        }
        
        .highlight-text {
            background: linear-gradient(120deg, rgba(79, 70, 229, 0.2) 0%, rgba(79, 70, 229, 0.4) 100%);
            padding: 0 5px;
            border-radius: 4px;
            font-weight: 600;
            animation: highlight 3s infinite;
        }
        
        .text-reveal {
            animation: textReveal 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            opacity: 0;
        }
        
        .slide-up {
            animation: slideUp 0.7s ease-out forwards;
            opacity: 0;
        }
        
        .letter-pop {
            display: inline-block;
            animation: letterPop 0.5s ease forwards;
            opacity: 0;
        }
        
        .color-shift {
            animation: colorShift 5s ease infinite;
        }
        
        .valence-electron {
            display: inline-block;
            animation: valenceElectronGlow 2s infinite;
            font-weight: bold;
            cursor: pointer;
            position: relative;
        }
        
        .valence-electron:hover::after {
            content: 'Valence Electron: The electron in the outermost shell of an atom';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            white-space: nowrap;
            z-index: 10;
            font-size: 14px;
            width: 300px;
        }
        
        .term-hover {
            position: relative;
            display: inline-block;
            cursor: help;
            border-bottom: 1px dashed #4f46e5;
            color: #4f46e5;
            font-weight: 500;
        }
        
        .term-hover:hover::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 150px;
            background-image: url('https://media.giphy.com/media/3o7aCTPPm4OHfRLSH6/giphy.gif');
            background-size: cover;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }
        
        .melting-point-chart {
            height: 300px;
            margin: 20px 0;
            position: relative;
        }
        
        .chart-bar {
            position: absolute;
            bottom: 0;
            width: 60px;
            background: linear-gradient(to top, #4f46e5, #7c3aed);
            border-radius: 6px 6px 0 0;
            transition: all 0.3s ease;
        }
        
        .chart-bar:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        .chart-label {
            position: absolute;
            bottom: -30px;
            width: 60px;
            text-align: center;
            font-weight: 500;
            color: white;
        }
        
        .chart-value {
            position: absolute;
            top: -25px;
            width: 60px;
            text-align: center;
            font-weight: 600;
            color: white;
        }
        
        /* Animation Delays */
        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }
        .delay-400 { animation-delay: 0.4s; }
        .delay-500 { animation-delay: 0.5s; }
        .delay-600 { animation-delay: 0.6s; }
        .delay-700 { animation-delay: 0.7s; }
        .delay-800 { animation-delay: 0.8s; }
        .delay-900 { animation-delay: 0.9s; }
        .delay-1000 { animation-delay: 1s; }
        .delay-1200 { animation-delay: 1.2s; }
        .delay-1500 { animation-delay: 1.5s; }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 260px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-nav {
            padding: 1rem 0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: #4b5563;
            text-decoration: none;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
            border-left-color: #4f46e5;
        }
        
        .nav-item.active {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
            border-left-color: #4f46e5;
            font-weight: 600;
        }
        
        .nav-item i {
            margin-right: 0.75rem;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem 1.5rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .main-content {
            margin-left: 260px;
            padding: 2rem;
            min-height: 100vh;
        }
        
        .menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 101;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        /* Learning Path Styles */
        .learning-path {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem 0;
            position: relative;
        }
        
        .learning-path::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            z-index: 0;
        }
        
        .path-step {
            background: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .path-step.active {
            background: #4f46e5;
            color: white;
            transform: scale(1.1);
        }
        
        .path-step.completed {
            background: #10b981;
            color: white;
        }
        
        .path-step.locked {
            background: #9ca3af;
            color: white;
        }
        
        .path-label {
            position: absolute;
            bottom: -30px;
            white-space: nowrap;
            font-size: 0.875rem;
            font-weight: 500;
            color: white;
        }
        
        /* Content Cards */
        .content-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #4f46e5;
        }
        
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .content-card.locked {
            opacity: 0.6;
            filter: grayscale(100%);
            cursor: not-allowed;
        }
        
        .content-card.locked:hover {
            transform: none;
        }
        
        /* Module Styles */
        .module {
            margin-bottom: 2rem;
        }
        
        .module-header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem 0.75rem 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .module-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .module-progress {
            font-size: 0.875rem;
            display: flex;
            align-items: center;
        }
        
        .module-content {
            background: white;
            padding: 1.5rem;
            border-radius: 0 0 0.75rem 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        /* Element Cards */
        .element-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .element-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .element-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
        }
        
        .element-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .element-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            object-fit: cover;
            border: 3px solid #e5e7eb;
        }
        
        /* Tab Styles */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #4f46e5;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .tab.active {
            color: #4f46e5;
        }
        
        .tab.active::after {
            transform: scaleX(1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Quiz Styles */
        .quiz-option {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            margin: 0.75rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            display: flex;
            align-items: center;
        }
        
        .quiz-option:hover {
            border-color: #4f46e5;
            background: #f3f4f6;
        }
        
        .quiz-option.selected {
            border-color: #4f46e5;
            background: #eef2ff;
        }
        
        .quiz-option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }
        
        .quiz-option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }
        
        .quiz-option input {
            margin-right: 0.75rem;
        }
        
        .quiz-option label {
            cursor: pointer;
            flex: 1;
        }
        
        /* Drag and Drop Styles */
        .drag-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .drag-item {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 10px 15px;
            cursor: move;
            transition: all 0.2s ease;
        }
        
        .drag-item:hover {
            background: #e5e7eb;
            transform: translateY(-2px);
        }
        
        .drag-item.dragging {
            opacity: 0.5;
        }
        
        .drop-targets-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .drop-target {
            background: #f9fafb;
            border: 2px dashed #d1d5db;
            border-radius: 6px;
            padding: 15px;
            min-width: 150px;
            min-height: 50px;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .drop-target.drag-over {
            background: #eff6ff;
            border-color: #3b82f6;
        }
        
        /* Fill in the Blank Styles */
        .blank-container {
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .blank-input {
            display: inline-block;
            width: 120px;
            padding: 5px 8px;
            margin: 0 5px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 1rem;
            text-align: center;
        }
        
        .blank-input:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
        }
        
        /* Matching Styles */
        .matching-container {
            display: flex;
            gap: 30px;
        }
        
        .matching-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .matching-item {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .matching-item:hover {
            background: #f3f4f6;
        }
        
        .matching-item.selected {
            background: #eef2ff;
            border-color: #4f46e5;
        }
        
        .matching-item.matched {
            background: #d1fae5;
            border-color: #10b981;
            cursor: default;
        }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            transition: width 0.3s ease;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }
        
        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #4b5563;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        /* Lock Overlay */
        .lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1rem;
            color: white;
            font-size: 3rem;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            display: flex;
            align-items: center;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast-icon {
            margin-right: 0.75rem;
            font-size: 1.25rem;
        }
        
        .toast.success .toast-icon {
            color: #10b981;
        }
        
        .toast.error .toast-icon {
            color: #ef4444;
        }
        
        .toast.info .toast-icon {
            color: #3b82f6;
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Landing Page Styles */
        .landing-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .landing-card {
            background: white;
            border-radius: 2rem;
            padding: 3rem;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .landing-icon {
            font-size: 4rem;
            color: #4f46e5;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }
        
        .landing-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .landing-subtitle {
            font-size: 1.25rem;
            color: #6b7280;
            margin-bottom: 2rem;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .feature-card {
            padding: 1.5rem;
            border-radius: 1rem;
            background: #f9fafb;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon {
            font-size: 2rem;
            color: #4f46e5;
            margin-bottom: 0.5rem;
            animation: bounce 2s infinite;
        }
        
        /* Pre-Quiz Introduction Styles */
        .prequiz-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .prequiz-card {
            background: white;
            border-radius: 2rem;
            padding: 3rem;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .prequiz-icon {
            font-size: 4rem;
            color: #4f46e5;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }
        
        .prequiz-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .prequiz-subtitle {
            font-size: 1.25rem;
            color: #6b7280;
            margin-bottom: 2rem;
        }
        
        .support-message {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 2rem 0;
            text-align: left;
        }
        
        .support-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.5rem;
        }
        
        .support-message p {
            color: #1e3a8a;
            line-height: 1.6;
        }
        
        /* Study Group Styles */
        .study-group-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .study-group-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .member-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.75rem;
            margin-right: -10px;
            border: 2px solid white;
        }
        
        /* Comment Styles */
        .comment-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .comment {
            background: #f9fafb;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #4f46e5;
            transition: all 0.3s ease;
        }
        
        .comment:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .comment-author {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .comment-text {
            color: #4b5563;
        }
        
        .comment-form {
            display: flex;
            margin-top: 1rem;
            gap: 0.5rem;
        }
        
        .comment-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        
        .comment-submit {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .comment-submit:hover {
            background: #4338ca;
        }
        
        /* Feedback Styles */
        .feedback-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .feedback-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .feedback-btn {
            flex: 1;
            padding: 1rem;
            border-radius: 0.5rem;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .feedback-btn:hover {
            background: #f3f4f6;
            transform: translateY(-2px);
        }
        
        .feedback-btn.active {
            background: #eef2ff;
            border-color: #4f46e5;
            color: #4f46e5;
        }
        
        .feedback-btn i {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .review-form {
            margin-top: 1.5rem;
        }
        
        .review-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            min-height: 100px;
            margin-bottom: 1rem;
        }
        
        .review-submit {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .review-submit:hover {
            background: #4338ca;
        }
        
        .review-list {
            margin-top: 1.5rem;
        }
        
        .review-item {
            background: #f9fafb;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #4f46e5;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .review-author {
            font-weight: 600;
            color: #1f2937;
        }
        
        .review-rating {
            color: #f59e0b;
        }
        
        .review-text {
            color: #4b5563;
        }
        
        /* Highlight Box */
        .highlight-box {
            background: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }
        
        .highlight-box:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .highlight-box h4 {
            color: #0c4a6e;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .highlight-box p {
            color: #075985;
        }
        
        /* Equation Box */
        .equation-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .equation-box:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .equation-box .equation {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0.5rem 0;
        }
        
        /* Key Point Box */
        .key-point {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }
        
        .key-point:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .key-point h4 {
            color: #92400e;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .key-point p {
            color: #78350f;
        }
        
        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .comparison-table th {
            background: #4f46e5;
            color: white;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
        }
        
        .comparison-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f9fafb;
        }
        
        .comparison-table tr:hover {
            background: #eef2ff;
        }
        
        /* Video Container */
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 0.75rem;
            margin: 1.5rem 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0.75rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .landing-title, .prequiz-title {
                font-size: 2rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .element-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .learning-path {
                flex-direction: column;
                gap: 2rem;
            }
            
            .learning-path::before {
                width: 4px;
                height: 100%;
                top: 0;
                left: 50%;
                right: auto;
                transform: translateX(-50%);
            }
            
            .comparison-table {
                font-size: 0.875rem;
            }
            
            .comparison-table th, .comparison-table td {
                padding: 0.5rem;
            }
            
            .matching-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .drag-items-container,
            .drop-targets-container {
                justify-content: center;
            }
            
            .blank-input {
                width: 100px;
            }
            
            .module-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Landing Page (shown when user hasn't signed in) -->
    <div id="landingPage" class="landing-container" style="display: none;">
        <div class="landing-card">
            <div class="landing-icon text-reveal delay-100">
                <i class="fas fa-atom"></i>
            </div>
            <h1 class="landing-title glow-text text-reveal delay-300">
                <span class="letter-pop delay-300">C</span>
                <span class="letter-pop delay-320">h</span>
                <span class="letter-pop delay-340">e</span>
                <span class="letter-pop delay-360">m</span>
                <span class="letter-pop delay-380">i</span>
                <span class="letter-pop delay-400">s</span>
                <span class="letter-pop delay-420">t</span>
                <span class="letter-pop delay-440">r</span>
                <span class="letter-pop delay-460">y</span>
                <span class="letter-pop delay-480"> </span>
                <span class="letter-pop delay-500">M</span>
                <span class="letter-pop delay-520">a</span>
                <span class="letter-pop delay-540">s</span>
                <span class="letter-pop delay-560">t</span>
                <span class="letter-pop delay-580">e</span>
                <span class="letter-pop delay-600">r</span>
                <span class="letter-pop delay-620">y</span>
            </h1>
            <p class="landing-subtitle text-reveal delay-700">
                Master <strong class="color-shift">Group 1 Alkali Metals</strong> through Interactive Learning
            </p>
            
            <div class="feature-grid">
                <div class="feature-card slide-up delay-800">
                    <div class="feature-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <h3 class="font-semibold">Pre-Assessment</h3>
                    <p class="text-sm text-gray-600">Test your <strong>current knowledge</strong></p>
                </div>
                <div class="feature-card slide-up delay-900">
                    <div class="feature-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3 class="font-semibold">Interactive Content</h3>
                    <p class="text-sm text-gray-600">Learn through <strong>engaging materials</strong></p>
                </div>
                <div class="feature-card slide-up delay-1000">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="font-semibold">Collaborative Learning</h3>
                    <p class="text-sm text-gray-600">Study with <strong>peers</strong></p>
                </div>
            </div>
            
            <div class="mt-8">
                <p class="text-lg font-semibold text-gray-700 mb-4 text-reveal delay-1100">Your Learning Journey</p>
                <div class="learning-path slide-up delay-1200">
                    <div class="path-step active">
                        <i class="fas fa-play"></i>
                        <span class="path-label">Pre-Quiz</span>
                    </div>
                    <div class="path-step locked">
                        <i class="fas fa-lock"></i>
                        <span class="path-label">Learn</span>
                    </div>
                    <div class="path-step locked">
                        <i class="fas fa-lock"></i>
                        <span class="path-label">Post-Quiz</span>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 space-y-4">
                <button onclick="showLoginModal()" class="btn btn-primary w-full slide-up delay-1300">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In to Begin
                </button>
                <button onclick="showSignupModal()" class="btn btn-secondary w-full slide-up delay-1500">
                    <i class="fas fa-user-plus"></i>
                    Create Account
                </button>
            </div>
        </div>
    </div>
    
    <!-- Pre-Quiz Introduction Page (shown after sign-in) -->
    <div id="prequizPage" class="prequiz-container" style="display: none;">
        <div class="prequiz-card">
            <div class="prequiz-icon text-reveal delay-100">
                <i class="fas fa-clipboard-list"></i>
            </div>
            <h1 class="prequiz-title glow-text text-reveal delay-300">
                <span class="letter-pop delay-300">P</span>
                <span class="letter-pop delay-320">r</span>
                <span class="letter-pop delay-340">e</span>
                <span class="letter-pop delay-360">-</span>
                <span class="letter-pop delay-380">A</span>
                <span class="letter-pop delay-400">s</span>
                <span class="letter-pop delay-420">s</span>
                <span class="letter-pop delay-440">e</span>
                <span class="letter-pop delay-460">s</span>
                <span class="letter-pop delay-480">s</span>
                <span class="letter-pop delay-500">m</span>
                <span class="letter-pop delay-520">e</span>
                <span class="letter-pop delay-540">n</span>
                <span class="letter-pop delay-560">t</span>
                <span class="letter-pop delay-580"> </span>
                <span class="letter-pop delay-600">Q</span>
                <span class="letter-pop delay-620">u</span>
                <span class="letter-pop delay-640">i</span>
                <span class="letter-pop delay-660">z</span>
            </h1>
            <p class="prequiz-subtitle text-reveal delay-700">
                Let's check your <strong class="color-shift">current knowledge</strong> of Group 1 Alkali Metals
            </p>
            
            <div class="support-message slide-up delay-800">
                <h3><i class="fas fa-lightbulb mr-2"></i>Before You Begin</h3>
                <p>This quiz helps us understand your <strong>current knowledge level</strong>. Don't worry if you don't know all the answers - this is just a <strong>starting point</strong>! Take your time, read each question carefully, and do your best. Your results will help us <strong>personalize your learning experience</strong>.</p>
            </div>
            
            <div class="bg-blue-50 p-4 rounded-lg mb-6 slide-up delay-900">
                <div class="flex items-center mb-2">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    <h3 class="font-semibold text-blue-800">Quiz Details</h3>
                </div>
                <ul class="text-left text-blue-700 space-y-1">
                    <li>• <strong>7 interactive questions</strong></li>
                    <li>• <strong>No time limit</strong></li>
                    <li>• <strong>Immediate feedback</strong> on answers</li>
                    <li>• <strong>Results saved</strong> to your profile</li>
                </ul>
            </div>
            
            <div class="mt-8">
                <button onclick="startPreQuiz()" class="btn btn-primary w-full slide-up delay-1000">
                    <i class="fas fa-play mr-2"></i>
                    Start Pre-Quiz
                </button>
            </div>
        </div>
    </div>
    
    <!-- Main App (shown after pre-quiz completion) -->
    <div id="mainApp" style="display: none;">
        <!-- Menu Toggle Button (Mobile) -->
        <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="flex items-center">
                    <i class="fas fa-atom text-indigo-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold text-gray-800">Chemistry Mastery</h1>
                </div>
                <p class="text-sm text-gray-600 mt-1">Group 1 - Alkali Metals</p>
            </div>
            
            <div class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="navigateToSection('overview')">
                    <i class="fas fa-home"></i>
                    <span>Overview</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('elements')">
                    <i class="fas fa-th"></i>
                    <span>Elements</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('properties')">
                    <i class="fas fa-flask"></i>
                    <span>Properties</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('reactions')">
                    <i class="fas fa-vial"></i>
                    <span>Reactions</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('study-groups')">
                    <i class="fas fa-users"></i>
                    <span>Study Groups</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('discussion')">
                    <i class="fas fa-comments"></i>
                    <span>Discussion</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('quiz')">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Final Quiz</span>
                </a>
            </div>
            
            <div class="sidebar-footer">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center">
                        <div class="bg-indigo-100 rounded-full p-2 mr-2">
                            <i class="fas fa-coins text-indigo-600"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700"><span id="userPoints">0</span> pts</span>
                    </div>
                    <div class="flex items-center">
                        <div class="bg-orange-100 rounded-full p-2 mr-2">
                            <i class="fas fa-fire text-orange-500"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700"><span id="userStreak">0</span></span>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">Signed in as:</span>
                    <span class="text-sm font-medium text-gray-800" id="userName">User</span>
                </div>
                <button onclick="signOut()" class="btn btn-secondary w-full mt-3 text-sm">
                    <i class="fas fa-sign-out-alt mr-1"></i>
                    Logout
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Learning Path -->
            <div class="mb-6">
                <div class="learning-path">
                    <div class="path-step completed">
                        <i class="fas fa-check"></i>
                        <span class="path-label">Pre-Quiz</span>
                    </div>
                    <div class="path-step active">
                        <i class="fas fa-book-open"></i>
                        <span class="path-label">Learn</span>
                    </div>
                    <div class="path-step">
                        <i class="fas fa-graduation-cap"></i>
                        <span class="path-label">Post-Quiz</span>
                    </div>
                </div>
            </div>
            
            <!-- Overview Section -->
            <div id="overview-section" class="content-section">
                <!-- Module 1: Introduction -->
                <div class="module fade-in">
                    <div class="module-header">
                        <h3 class="module-title">Module 1: Introduction to Group 1</h3>
                        <div class="module-progress">
                            <i class="fas fa-check-circle text-green-400 mr-1"></i>
                            <span>Completed</span>
                        </div>
                    </div>
                    <div class="module-content">
                        <!-- Hero Section -->
                        <div class="text-center mb-8">
                            <h2 class="text-3xl font-bold text-white mb-3 glow-text">Group 1: The Alkali Metals</h2>
                            <p class="text-lg text-white/90 max-w-2xl mx-auto">
                                Explore the <strong>most reactive metals</strong> in the periodic table
                            </p>
                        </div>
                        
                        <!-- Introduction -->
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-info-circle mr-2 text-indigo-600"></i>
                                Introduction
                            </h3>
                            <p class="text-gray-700 mb-4">
                                Group 1 elements, known as the <strong>alkali metals</strong>, occupy the first column of the periodic table. 
                                They consist of lithium (Li), sodium (Na), potassium (K), rubidium (Rb), cesium (Cs), and francium (Fr). 
                                These elements share similar properties because they all have <span class="valence-electron">1</span> valence electron in their outer shell, 
                                which they readily lose to form +1 ions.
                            </p>
                            
                            <div class="highlight-box">
                                <h4>Electron Configuration</h4>
                                <p>All Group 1 elements have an electron configuration that ends with a <strong>single electron</strong> in the outermost shell, such as lithium 2,1, sodium 2,8,1, and potassium 2,8,8,1; this single <span class="term-hover">valence electron</span> is <strong>easily lost</strong>, which makes these elements highly reactive metals.</p>
                            </div>
                            
                            <p class="text-gray-700 mt-4">
                                Alkali metals are <strong>soft, shiny metals</strong> with low densities and low melting points. 
                                Their reactivity increases as you move down the group. Due to their <strong>high reactivity</strong>, 
                                they are never found free in nature but always occur in compounds, often as chlorides, 
                                carbonates, or sulfates.
                            </p>
                        </div>
                        
                        <!-- Key Characteristics -->
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-star mr-2 text-indigo-600"></i>
                                Key Characteristics
                            </h3>
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold text-gray-700 mb-3">Physical Properties</h4>
                                    <ul class="space-y-2 text-gray-600">
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Soft metals</strong> that can be cut with a knife</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Low density</strong> - lithium floats on water</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Low melting and boiling points</strong></span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Good conductors</strong> of heat and electricity</span>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-700 mb-3">Chemical Properties</h4>
                                    <ul class="space-y-2 text-gray-600">
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Highly reactive</strong> with one valence electron</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span>Form <strong>+1 ions</strong> by losing their valence electron</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Reactivity increases</strong> down the group</span>
                                        </li>
                                        <li class="flex items-start">
                                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                            <span><strong>Never found free</strong> in nature</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="key-point mt-4">
                                <h4>Remember</h4>
                                <p>Group 1 metals are <strong>so reactive</strong> they must be stored under oil to prevent reaction with air and moisture!</p>
                            </div>
                        </div>
                        
                        <!-- Video Section -->
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-video mr-2 text-indigo-600"></i>
                                Video Explanation
                            </h3>
                            <div class="video-container">
                                <iframe src="https://www.youtube.com/embed/6p2JnxKEI1k" title="Group 1 Alkali Metals" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Module 2: Applications -->
                <div class="module fade-in">
                    <div class="module-header">
                        <h3 class="module-title">Module 2: Real-World Applications</h3>
                        <div class="module-progress">
                            <i class="fas fa-check-circle text-green-400 mr-1"></i>
                            <span>Completed</span>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-industry mr-2 text-indigo-600"></i>
                                Real-World Applications
                            </h3>
                            <div class="grid md:grid-cols-3 gap-4">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-blue-800 mb-2">Lithium</h4>
                                    <p class="text-sm text-blue-600">Used in <strong>batteries</strong> for phones and electric vehicles, glass production, and as a medication for bipolar disorder</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-800 mb-2">Sodium</h4>
                                    <p class="text-sm text-green-600">Essential for life (<strong>nerve function</strong>), used in street lights (sodium vapor lamps), and food preservation (salt)</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-purple-800 mb-2">Potassium</h4>
                                    <p class="text-sm text-purple-600">Vital for plants (<strong>fertilizers</strong>), essential for nerve and muscle function in animals, used in soap production</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Elements Section -->
            <div id="elements-section" class="content-section" style="display: none;">
                <!-- Module 3: Element Details -->
                <div class="module fade-in">
                    <div class="module-header">
                        <h3 class="module-title">Module 3: Meet the Elements</h3>
                        <div class="module-progress">
                            <i class="fas fa-check-circle text-green-400 mr-1"></i>
                            <span>Completed</span>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-th mr-2 text-indigo-600"></i>
                                Meet the Elements
                            </h3>
                            <div class="element-grid">
                                <div class="element-card">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/e/ed/Lithiumcut_cropped.jpg" alt="Lithium" class="element-image">
                                    <h4 class="font-bold text-lg">Lithium (Li)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>3</strong></p>
                                </div>
                                <div class="element-card">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/27/Na_%28Sodium%29.jpg" alt="Sodium" class="element-image">
                                    <h4 class="font-bold text-lg">Sodium (Na)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>11</strong></p>
                                </div>
                                <div class="element-card">
                                    <img src="https://cdn.britannica.com/77/131177-050-79292189/fragments-Potassium-metal.jpg" alt="Potassium" class="element-image">
                                    <h4 class="font-bold text-lg">Potassium (K)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>19</strong></p>
                                </div>
                                <div class="element-card">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c9/Rb5.JPG" alt="Rubidium" class="element-image">
                                    <h4 class="font-bold text-lg">Rubidium (Rb)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>37</strong></p>
                                </div>
                                <div class="element-card">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/3/3d/Cesium.jpg" alt="Cesium" class="element-image">
                                    <h4 class="font-bold text-lg">Cesium (Cs)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>55</strong></p>
                                </div>
                                <div class="element-card">
                                    <img src="https://i0.wp.com/periodic-table.com/wp-content/uploads/2018/11/Francium.jpg?fit=238%2C212&ssl=1" alt="Francium" class="element-image">
                                    <h4 class="font-bold text-lg">Francium (Fr)</h4>
                                    <p class="text-sm text-gray-600">Atomic: <strong>87</strong></p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Element Details -->
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-info mr-2 text-indigo-600"></i>
                                Element Details
                            </h3>
                            <div class="overflow-x-auto">
                                <table class="comparison-table">
                                    <thead>
                                        <tr>
                                            <th>Element</th>
                                            <th>Symbol</th>
                                            <th>Atomic Number</th>
                                            <th>Electron Configuration</th>
                                            <th>Density (g/cm³)</th>
                                            <th>Melting Point (°C)</th>
                                            <th>Key Uses</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="font-medium">Lithium</td>
                                            <td>Li</td>
                                            <td>3</td>
                                            <td>2, 1</td>
                                            <td>0.534</td>
                                            <td>180.5</td>
                                            <td><strong>Batteries</strong>, ceramics, mood stabilizers</td>
                                        </tr>
                                        <tr>
                                            <td class="font-medium">Sodium</td>
                                            <td>Na</td>
                                            <td>11</td>
                                            <td>2, 8, 1</td>
                                            <td>0.968</td>
                                            <td>97.8</td>
                                            <td><strong>Street lights</strong>, salt, soap</td>
                                        </tr>
                                        <tr>
                                            <td class="font-medium">Potassium</td>
                                            <td>K</td>
                                            <td>19</td>
                                            <td>2, 8, 8, 1</td>
                                            <td>0.89</td>
                                            <td>63.5</td>
                                            <td><strong>Fertilizers</strong>, soap, glass</td>
                                        </tr>
                                        <tr>
                                            <td class="font-medium">Rubidium</td>
                                            <td>Rb</td>
                                            <td>37</td>
                                            <td>2, 8, 18, 8,1</td>
                                            <td>1.532</td>
                                            <td>39.3</td>
                                            <td><strong>Atomic clocks</strong>, photocells</td>
                                        </tr>
                                        <tr>
                                            <td class="font-medium">Cesium</td>
                                            <td>Cs</td>
                                            <td>55</td>
                                            <td>2, 8, 18, 18, 8, 1</td>
                                            <td>1.93</td>
                                            <td>28.4</td>
                                            <td><strong>Atomic clocks</strong>, drilling fluids</td>
                                        </tr>
                                        <tr>
                                            <td class="font-medium">Francium</td>
                                            <td>Fr</td>
                                            <td>87</td>
                                            <td>2, 8, 18, 32, 18, 8, 1</td>
                                            <td>~1.87</td>
                                            <td>~27</td>
                                            <td><strong>Research purposes</strong> only</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="highlight-box mt-4">
                                <h4>Occurrence and Extraction</h4>
                                <p>Group 1 metals are <strong>never found free</strong> in nature due to their high reactivity. They are typically found as:
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Chlorides</strong> (e.g., rock salt - NaCl)</li>
                                    <li><strong>Carbonates</strong> (e.g., limestone - CaCO₃, which contains Na and K impurities)</li>
                                    <li><strong>Sulfates</strong> (e.g., Chile saltpeter - NaNO₃)</li>
                                </ul>
                                <p class="mt-2">They are extracted by <strong>electrolysis</strong> of their molten chlorides, as chemical reduction is not possible.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Properties Section -->
            <div id="properties-section" class="content-section" style="display: none;">
                <!-- Module 4: Properties -->
                <div class="module fade-in">
                    <div class="module-header">
                        <h3 class="module-title">Module 4: Properties & Characteristics</h3>
                        <div class="module-progress">
                            <i class="fas fa-check-circle text-green-400 mr-1"></i>
                            <span>Completed</span>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-flask mr-2 text-indigo-600"></i>
                                Properties & Characteristics
                            </h3>
                            
                            <div class="tabs">
                                <button class="tab active" onclick="showTab('physical')">Physical</button>
                                <button class="tab" onclick="showTab('chemical')">Chemical</button>
                                <button class="tab" onclick="showTab('trends')">Trends</button>
                            </div>
                            
                            <div id="physical" class="tab-content active">
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-2">Physical Properties</h4>
                                        <ul class="space-y-2 text-gray-600">
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Soft metals</strong> that can be cut with a knife</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Low density</strong> - lithium floats on water</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Low melting and boiling points</strong></span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Good conductors</strong> of heat and electricity</span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-2">Appearance</h4>
                                        <ul class="space-y-2 text-gray-600">
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Silvery-white, shiny metals</strong></span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Tarnish quickly</strong> in air</span>
                                            </li>
                                            <li class="flex items-start">
                                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                                <span><strong>Freshly cut surfaces</strong> are highly reflective</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="highlight-box mt-4">
                                    <h4>Why are Group 1 metals soft?</h4>
                                    <p>Group 1 metals have a <strong>metallic structure</strong> held together by metallic bonds. The bonds are <strong>relatively weak</strong> because:
                                    <ul class="list-disc pl-5 mt-2">
                                        <li>Each atom contributes only <strong>one electron</strong> to the "sea" of delocalized electrons</li>
                                        <li>The <strong>atomic radius is relatively large</strong></li>
                                        <li>The <strong>charge on the cation is only +1</strong></li>
                                    </ul>
                                    <p class="mt-2">These factors result in <strong>weak metallic bonding</strong>, making the metals soft with low melting points.</p>
                                </div>
                            </div>
                            
                            <div id="chemical" class="tab-content">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-2">Chemical Properties</h4>
                                        <p class="text-gray-600 mb-4">
                                            Group 1 elements are <strong>highly reactive metals</strong> with one valence electron that they readily lose to form +1 ions.
                                        </p>
                                        <div class="equation-box">
                                            <p class="text-gray-700 mb-2">General ionization reaction:</p>
                                            <p class="equation">M → M⁺ + e⁻</p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-2">Reactivity</h4>
                                        <p class="text-gray-600">
                                            Reactivity increases down the group as the atomic radius increases and the valence electron is further from the nucleus, making it <strong>easier to lose</strong>. This is shown by the <strong>decreasing first ionization energy</strong> down the group.
                                        </p>
                                        
                                        <div class="highlight-box mt-3">
                                            <h4>Ionization Energy Trend</h4>
                                            <p>First ionization energy decreases down Group 1 because:
                                            <ul class="list-disc pl-5 mt-2">
                                                <li><strong>Atomic radius increases</strong></li>
                                                <li><strong>Outer electron is further from the nucleus</strong></li>
                                                <li><strong>More inner electron shells shield</strong> the outer electron from the nucleus</li>
                                            </ul>
                                            <p class="mt-2">This makes it <strong>easier to remove</strong> the outer electron, increasing reactivity.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="trends" class="tab-content">
                                <div class="space-y-4">
                                    <h4 class="font-semibold text-gray-700 mb-3">Trends Down Group 1</h4>
                                    
                                    <div class="overflow-x-auto">
                                        <table class="comparison-table">
                                            <thead>
                                                <tr>
                                                    <th>Property</th>
                                                    <th>Trend</th>
                                                    <th>Reason</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Atomic radius</td>
                                                    <td><strong>Increases</strong></td>
                                                    <td>More electron shells</td>
                                                </tr>
                                                <tr>
                                                    <td>First ionization energy</td>
                                                    <td><strong>Decreases</strong></td>
                                                    <td>Outer electron further from nucleus</td>
                                                </tr>
                                                <tr>
                                                    <td>Reactivity</td>
                                                    <td><strong>Increases</strong></td>
                                                    <td>Easier to lose valence electron</td>
                                                </tr>
                                                <tr>
                                                    <td>Melting/boiling point</td>
                                                    <td><strong>Decreases</strong></td>
                                                    <td>Weaker metallic bonding</td>
                                                </tr>
                                                <tr>
                                                    <td>Density</td>
                                                    <td><strong>Increases</strong></td>
                                                    <td>Exception: K < Na</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    <div class="key-point">
                                        <h4>Important Exception</h4>
                                        <p>While density generally increases down Group 1, <strong>potassium (K) is less dense than sodium (Na)</strong>. This is because the increase in atomic mass is offset by a larger increase in atomic volume.</p>
                                    </div>
                                    
                                    <!-- Melting Point Chart -->
                                    <div class="content-card mt-4">
                                        <h4 class="font-semibold text-gray-700 mb-3">Melting Point Trend</h4>
                                        <p class="text-gray-600 mb-4">The melting points of Group 1 metals decrease down the group due to weaker metallic bonding.</p>
                                        
                                        <div class="melting-point-chart">
                                            <div class="chart-bar" style="left: 20px; height: 180.5px;">
                                                <div class="chart-value">180.5°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 20px;">Li</div>
                                            
                                            <div class="chart-bar" style="left: 120px; height: 97.8px;">
                                                <div class="chart-value">97.8°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 120px;">Na</div>
                                            
                                            <div class="chart-bar" style="left: 220px; height: 63.5px;">
                                                <div class="chart-value">63.5°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 220px;">K</div>
                                            
                                            <div class="chart-bar" style="left: 320px; height: 39.3px;">
                                                <div class="chart-value">39.3°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 320px;">Rb</div>
                                            
                                            <div class="chart-bar" style="left: 420px; height: 28.4px;">
                                                <div class="chart-value">28.4°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 420px;">Cs</div>
                                            
                                            <div class="chart-bar" style="left: 520px; height: 27px;">
                                                <div class="chart-value">~27°C</div>
                                            </div>
                                            <div class="chart-label" style="left: 520px;">Fr</div>
                                        </div>
                                    </div>
                                    
                                    <div class="highlight-box mt-3">
                                        <h4>Practical Observation of Trends</h4>
                                        <p>The reactivity trend can be clearly observed in the reaction with water:
                                        <ul class="list-disc pl-5 mt-2">
                                            <li><strong>Lithium:</strong> Fizzes steadily, moves slowly on surface</li>
                                            <li><strong>Sodium:</strong> Fizzes rapidly, melts into a ball, moves quickly</li>
                                            <li><strong>Potassium:</strong> Fizzes very rapidly, may ignite with lilac flame, moves very quickly</li>
                                        </ul>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Reactions Section -->
            <div id="reactions-section" class="content-section" style="display: none;">
                <!-- Module 5: Chemical Reactions -->
                <div class="module fade-in">
                    <div class="module-header">
                        <h3 class="module-title">Module 5: Chemical Reactions</h3>
                        <div class="module-progress">
                            <i class="fas fa-check-circle text-green-400 mr-1"></i>
                            <span>Completed</span>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="content-card">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-vial mr-2 text-indigo-600"></i>
                                Chemical Reactions
                            </h3>
                            
                            <div class="tabs">
                                <button class="tab active" onclick="showTab('water')">With Water</button>
                                <button class="tab" onclick="showTab('oxygen')">With Oxygen</button>
                                <button class="tab" onclick="showTab('halogens')">With Halogens</button>
                                <button class="tab" onclick="showTab('acids')">With Acids</button>
                            </div>
                            
                            <div id="water" class="tab-content active">
                                <div class="space-y-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-3">Reaction with Water</h4>
                                        <div class="equation-box">
                                            <p class="text-gray-700 mb-2">General equation:</p>
                                            <p class="equation">2M(s) + 2H₂O(l) → 2MOH(aq) + H₂(g)</p>
                                        </div>
                                        <p class="text-gray-600 mb-4">
                                            All Group 1 metals react with water to produce <strong>hydrogen gas</strong> and the corresponding <strong>metal hydroxide</strong>. 
                                            The reactivity increases down the group, with lithium reacting relatively slowly and cesium reacting explosively.
                                        </p>
                                        
                                        <div class="highlight-box">
                                            <h4>Observations for Different Metals</h4>
                                            <div class="grid md:grid-cols-3 gap-4 mt-3">
                                                <div class="bg-blue-50 p-3 rounded-lg">
                                                    <h5 class="font-semibold text-blue-800">Lithium</h5>
                                                    <p class="text-sm text-blue-600"><strong>Fizzes steadily</strong></p>
                                                    <p class="text-xs text-blue-500 mt-1">Doesn't melt</p>
                                                    <p class="text-xs text-blue-500 mt-1">Moves slowly on surface</p>
                                                </div>
                                                <div class="bg-blue-50 p-3 rounded-lg">
                                                    <h5 class="font-semibold text-blue-800">Sodium</h5>
                                                    <p class="text-sm text-blue-600"><strong>Fizzes rapidly</strong></p>
                                                    <p class="text-xs text-blue-500 mt-1">Melts into a ball</p>
                                                    <p class="text-xs text-blue-500 mt-1">Moves quickly on surface</p>
                                                </div>
                                                <div class="bg-blue-50 p-3 rounded-lg">
                                                    <h5 class="font-semibold text-blue-800">Potassium</h5>
                                                    <p class="text-sm text-blue-600"><strong>Fizzes very rapidly</strong></p>
                                                    <p class="text-xs text-blue-500 mt-1">Ignites with lilac flame</p>
                                                    <p class="text-xs text-blue-500 mt-1">May explode</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-3">Reaction Mechanism</h4>
                                        <p class="text-gray-600">
                                            The reaction with water is a <strong>redox reaction</strong> where the metal is oxidized and water is reduced:
                                        </p>
                                        <div class="equation-box">
                                            <p class="text-gray-700 mb-2">Oxidation: 2M → 2M⁺ + 2e⁻</p>
                                            <p class="text-gray-700 mb-2">Reduction: 2H₂O + 2e⁻ → 2OH⁻ + H₂</p>
                                            <p class="text-gray-700">Overall: 2M + 2H₂O → 2MOH + H₂</p>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-indigo-50 p-4 rounded-lg">
                                        <h5 class="font-semibold text-indigo-800 mb-2">Safety Note:</h5>
                                        <p class="text-indigo-700">
                                            Due to their <strong>violent reactions</strong> with water, Group 1 metals must be stored under oil to prevent contact with moisture in the air. 
                                            Small pieces should always be used for demonstrations, and <strong>safety goggles</strong> must be worn.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="oxygen" class="tab-content">
                                <div class="space-y-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-3">Reaction with Oxygen</h4>
                                        <p class="text-gray-600 mb-4">
                                            Group 1 metals react with oxygen to form <strong>oxides, peroxides, or superoxides</strong> depending on the metal and reaction conditions.
                                        </p>
                                        
                                        <div class="grid md:grid-cols-3 gap-4">
                                            <div class="bg-green-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-green-800">Lithium</h5>
                                                <p class="text-sm text-green-600">Forms <strong>Li₂O (oxide)</strong></p>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">4Li + O₂ → 2Li₂O</p>
                                                </div>
                                            </div>
                                            <div class="bg-green-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-green-800">Sodium</h5>
                                                <p class="text-sm text-green-600">Forms <strong>Na₂O₂ (peroxide)</strong></p>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">2Na + O₂ → Na₂O₂</p>
                                                </div>
                                            </div>
                                            <div class="bg-green-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-green-800">Potassium</h5>
                                                <p class="text-sm text-green-600">Forms <strong>KO₂ (superoxide)</strong></p>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">K + O₂ → KO₂</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h5 class="font-semibold text-gray-700 mb-2">Trend in Oxide Formation:</h5>
                                        <p class="text-gray-600">
                                            As we move down the group, the tendency to form peroxides and superoxides increases due to the <strong>larger size of the metal ions</strong>, which can stabilize larger anions.
                                        </p>
                                        
                                        <div class="highlight-box mt-3">
                                            <h4>Why the Change in Products?</h4>
                                            <p>The stability of different oxides depends on the <strong>size of the cation</strong>:
                                            <ul class="list-disc pl-5 mt-2">
                                                <li><strong>Small Li⁺</strong> stabilizes the small O²⁻ ion in Li₂O</li>
                                                <li><strong>Medium Na⁺</strong> stabilizes the O₂²⁻ ion in Na₂O₂</li>
                                                <li><strong>Large K⁺, Rb⁺, Cs⁺</strong> stabilize the large O₂⁻ ion in superoxides</li>
                                            </ul>
                                            <p class="mt-2">This is an example of how <strong>cation size affects compound stability</strong>.</p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h5 class="font-semibold text-gray-700 mb-2">Reactions of the Oxides with Water</h5>
                                        <p class="text-gray-600">All Group 1 oxides, peroxides, and superoxides react with water to form <strong>alkaline solutions</strong>:</p>
                                        <div class="grid md:grid-cols-3 gap-4 mt-3">
                                            <div class="bg-purple-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-purple-800">Oxide</h5>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">Li₂O + H₂O → 2LiOH</p>
                                                </div>
                                            </div>
                                            <div class="bg-purple-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-purple-800">Peroxide</h5>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">Na₂O₂ + 2H₂O → 2NaOH + H₂O₂</p>
                                                </div>
                                            </div>
                                            <div class="bg-purple-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-purple-800">Superoxide</h5>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">2KO₂ + 2H₂O → 2KOH + H₂O₂ + O₂</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="halogens" class="tab-content">
                                <div class="space-y-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-3">Reaction with Halogens</h4>
                                        <div class="equation-box">
                                            <p class="text-gray-700 mb-2">General equation:</p>
                                            <p class="equation">2M(s) + X₂ → 2MX(s)</p>
                                            <p class="text-gray-600 text-sm">Where X = F, Cl, Br, I</p>
                                        </div>
                                        <p class="text-gray-600 mb-4">
                                            Group 1 metals react <strong>vigorously</strong> with halogens to form ionic halides. These reactions are <strong>highly exothermic</strong> and often produce bright flames.
                                        </p>
                                        <div class="grid md:grid-cols-2 gap-4">
                                            <div class="bg-purple-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-purple-800">With Chlorine</h5>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">2Na + Cl₂ → 2NaCl</p>
                                                </div>
                                                <p class="text-sm text-purple-600 mt-2"><strong>Bright yellow flame</strong></p>
                                            </div>
                                            <div class="bg-purple-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-purple-800">With Bromine</h5>
                                                <div class="equation-box mt-2">
                                                    <p class="equation text-sm">2K + Br₂ → 2KBr</p>
                                                </div>
                                                <p class="text-sm text-purple-600 mt-2"><strong>Red-brown vapor</strong></p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-purple-50 p-4 rounded-lg">
                                        <h5 class="font-semibold text-purple-800 mb-2">Properties of Halides:</h5>
                                        <ul class="text-sm text-purple-700 space-y-1">
                                            <li>• All are <strong>white crystalline solids</strong> at room temperature</li>
                                            <li>• <strong>High melting and boiling points</strong> due to strong ionic bonding</li>
                                            <li>• <strong>Soluble in water</strong>, forming neutral solutions</li>
                                            <li>• <strong>Conduct electricity</strong> when molten or in aqueous solution</li>
                                        </ul>
                                    </div>
                                    
                                    <div>
                                        <h5 class="font-semibold text-gray-700 mb-2">Test for Halide Ions</h5>
                                        <p class="text-gray-600">
                                            The halide ions (Cl⁻, Br⁻, I⁻) can be identified using <strong>silver nitrate solution</strong>:
                                        </p>
                                        <div class="grid md:grid-cols-3 gap-4 mt-3">
                                            <div class="bg-yellow-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-yellow-800">Chloride</h5>
                                                <p class="text-sm text-yellow-600">Forms <strong>white precipitate</strong> of AgCl</p>
                                                <p class="text-xs text-yellow-500 mt-1">Soluble in dilute NH₃</p>
                                            </div>
                                            <div class="bg-yellow-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-yellow-800">Bromide</h5>
                                                <p class="text-sm text-yellow-600">Forms <strong>cream precipitate</strong> of AgBr</p>
                                                <p class="text-xs text-yellow-500 mt-1">Partially soluble in conc. NH₃</p>
                                            </div>
                                            <div class="bg-yellow-50 p-3 rounded-lg">
                                                <h5 class="font-semibold text-yellow-800">Iodide</h5>
                                                <p class="text-sm text-yellow-600">Forms <strong>yellow precipitate</strong> of AgI</p>
                                                <p class="text-xs text-yellow-500 mt-1">Insoluble in NH₃</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="acids" class="tab-content">
                                <div class="space-y-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-700 mb-3">Reaction with Acids</h4>
                                        <div class="equation-box">
                                            <p class="text-gray-700 mb-2">General equation:</p>
                                            <p class="equation">2M(s) + 2H⁺(aq) → 2M⁺(aq) + H₂(g)</p>
                                        </div>
                                        <p class="text-gray-600 mb-4">
                                            Group 1 metals react with acids to produce <strong>hydrogen gas</strong> and the corresponding salt. These reactions are <strong>extremely vigorous and dangerous</strong> due to the high reactivity of the metals.
                                        </p>
                                        
                                        <div class="bg-red-50 p-4 rounded-lg mb-4">
                                            <h5 class="font-semibold text-red-800 mb-2">⚠️ Safety Warning:</h5>
                                            <p class="text-red-700">
                                                These reactions are <strong>too violent</strong> to be performed safely in a school laboratory. The hydrogen gas produced is <strong>highly flammable</strong> and can explode. 
                                                Never attempt to react Group 1 metals with acids outside of specialized facilities with proper safety equipment.
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h5 class="font-semibold text-gray-700 mb-2">Example Reactions:</h5>
                                        <div class="space-y-2">
                                            <div class="bg-gray-50 p-3 rounded-lg">
                                                <p class="text-sm font-mono">2Li(s) + 2HCl(aq) → 2LiCl(aq) + H₂(g)</p>
                                            </div>
                                            <div class="bg-gray-50 p-3 rounded-lg">
                                                <p class="text-sm font-mono">2Na(s) + H₂SO₄(aq) → Na₂SO₄(aq) + H₂(g)</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h5 class="font-semibold text-gray-700 mb-2">Reaction Mechanism</h5>
                                        <p class="text-gray-600">
                                            The reaction with acids is a <strong>redox reaction</strong> where the metal is oxidized and hydrogen ions from the acid are reduced:
                                        </p>
                                        <div class="equation-box mt-3">
                                            <p class="text-gray-700 mb-2">Oxidation: 2M → 2M⁺ + 2e⁻</p>
                                            <p class="text-gray-700 mb-2">Reduction: 2H⁺ + 2e⁻ → H₂</p>
                                            <p class="text-gray-700">Overall: 2M + 2H⁺ → 2M⁺ + H₂</p>
                                        </div>
                                    </div>
                                    
                                    <div class="highlight-box">
                                        <h4>Why So Vigorous?</h4>
                                        <p>The reaction with acids is more vigorous than with water because:
                                        <ul class="list-disc pl-5 mt-2">
                                            <li>Acids provide a <strong>higher concentration of H⁺ ions</strong> than water</li>
                                            <li>The <strong>reduction potential of H⁺ is higher</strong> than that of H₂O</li>
                                            <li>This makes the reaction <strong>more thermodynamically favorable</strong></li>
                                        </ul>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Study Groups Section -->
            <div id="study-groups-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-users mr-2 text-indigo-600"></i>
                            Study Circles
                        </h3>
                        <button onclick="showCreateStudyGroup()" class="btn btn-primary">
                            <i class="fas fa-plus"></i>
                            Create Group
                        </button>
                    </div>
                    <div id="studyGroupsContainer">
                        <!-- Study groups will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Discussion Section -->
            <div id="discussion-section" class="content-section" style="display: none;">
                <div class="comment-section fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-comments mr-2 text-indigo-600"></i>
                        Discussion
                    </h3>
                    <div id="commentsContainer">
                        <!-- Comments will be loaded here -->
                    </div>
                    <div class="comment-form">
                        <input type="text" id="commentInput" class="comment-input" placeholder="Share your thoughts...">
                        <button onclick="addComment()" class="comment-submit">Post</button>
                    </div>
                </div>
                
                <!-- Feedback Section -->
                <div class="feedback-section fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-thumbs-up mr-2 text-indigo-600"></i>
                        Feedback
                    </h3>
                    
                    <div class="feedback-buttons">
                        <div class="feedback-btn" onclick="submitFeedback('thumbs-up')">
                            <i class="fas fa-thumbs-up"></i>
                            <p>Helpful</p>
                        </div>
                        <div class="feedback-btn" onclick="submitFeedback('thumbs-down')">
                            <i class="fas fa-thumbs-down"></i>
                            <p>Not Helpful</p>
                        </div>
                    </div>
                    
                    <div class="review-form">
                        <h4 class="font-semibold text-gray-700 mb-2">Write a Review</h4>
                        <textarea id="reviewText" class="review-textarea" placeholder="Share your experience with this learning module..."></textarea>
                        <button onclick="submitReview()" class="review-submit">Submit Review</button>
                    </div>
                    
                    <div class="review-list" id="reviewList">
                        <!-- Reviews will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Post Quiz Section -->
            <div id="quiz-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-graduation-cap mr-2 text-indigo-600"></i>
                        Final Assessment
                    </h3>
                    <p class="text-gray-600 mb-4">
                        Test your knowledge after completing the learning materials. See how much you've <strong>improved</strong>!
                    </p>
                    <button onclick="startPostQuiz()" class="btn btn-primary">
                        <i class="fas fa-play"></i>
                        Start Post-Quiz
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="text-center mb-6">
                <i class="fas fa-atom text-4xl text-indigo-600 mb-3"></i>
                <h2 class="text-2xl font-bold text-gray-800">Welcome to Chemistry Mastery</h2>
                <p class="text-gray-600">Sign in to begin your <strong>learning journey</strong></p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="your@email.com" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Or continue with</p>
                <button onclick="signInWithGoogle()" class="btn btn-secondary w-full mt-2">
                    <i class="fab fa-google"></i>
                    Google
                </button>
            </div>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Don't have an account?</p>
                <button onclick="switchToSignup()" class="btn btn-secondary w-full mt-2">
                    <i class="fas fa-user-plus"></i>
                    Create Account
                </button>
            </div>
        </div>
    </div>
    
    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <div class="text-center mb-6">
                <i class="fas fa-atom text-4xl text-indigo-600 mb-3"></i>
                <h2 class="text-2xl font-bold text-gray-800">Create Your Account</h2>
                <p class="text-gray-600">Join us to start your <strong>learning journey</strong></p>
            </div>
            
            <form id="signupForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" id="fullName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="John Doe" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="signupEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="your@email.com" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="signupPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
                    <input type="password" id="confirmPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-user-plus"></i>
                    Create Account
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Already have an account?</p>
                <button onclick="switchToLogin()" class="btn btn-secondary w-full mt-2">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In
                </button>
            </div>
        </div>
    </div>
    
    <!-- Quiz Modal -->
    <div id="quizModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800" id="quizTitle">Pre-Quiz</h2>
                <button onclick="closeQuiz()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="quizProgress" class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-600">Question <span id="currentQuestion">1</span> of <span id="totalQuestions">7</span></span>
                    <span class="text-sm text-gray-600">Score: <span id="currentScore">0</span></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 14.3%"></div>
                </div>
            </div>
            
            <div id="quizContent">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-4" id="questionText">Loading question...</h3>
                    <div id="optionsContainer"></div>
                </div>
                
                <div id="feedback" class="hidden mb-4 p-3 rounded-lg text-sm"></div>
                
                <div class="flex justify-between items-center">
                    <button id="prevButton" class="btn btn-secondary hidden" onclick="previousQuestion()">
                        <i class="fas fa-arrow-left"></i>
                        Previous
                    </button>
                    <div class="flex gap-2">
                        <button id="submitButton" class="btn btn-primary" onclick="submitAnswer()">
                            Submit Answer
                        </button>
                        <button id="nextButton" class="btn btn-primary hidden" onclick="nextQuestion()">
                            Next
                            <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="quizResults" class="hidden text-center">
                <i class="fas fa-trophy text-5xl text-yellow-500 mb-4"></i>
                <h3 class="text-2xl font-bold mb-3">Quiz Complete!</h3>
                <div class="text-4xl font-bold text-indigo-600 mb-3" id="finalScore">0/7</div>
                <p class="text-gray-600 mb-6" id="scoreMessage">Great job!</p>
                
                <div id="postQuizActions" class="hidden">
                    <button onclick="completePreQuiz()" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i>
                        Continue to Learning Materials
                    </button>
                </div>
                
                <div id="finalActions" class="hidden">
                    <button onclick="closeQuiz()" class="btn btn-primary">
                        <i class="fas fa-check"></i>
                        Finish
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Create Study Group Modal -->
    <div id="createStudyGroupModal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Create Study Group</h2>
            
            <form id="createStudyGroupForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Group Name</label>
                    <input type="text" id="groupName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter group name" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="groupDescription" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" rows="3" placeholder="Describe your study group" required></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Goal</label>
                    <input type="text" id="groupGoal" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="What's the goal of this group?" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Max Members</label>
                    <select id="groupMaxMembers" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                        <option value="5">5 members</option>
                        <option value="10">10 members</option>
                        <option value="15">15 members</option>
                        <option value="20">20 members</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-plus"></i>
                    Create Group
                </button>
            </form>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer"></div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; align-items: center; justify-content: center;">
        <div class="bg-white rounded-lg p-6 text-center">
            <div class="spinner"></div>
            <p class="mt-2 text-gray-600">Loading...</p>
        </div>
    </div>
    
    <script>
        // Google Sheets API Configuration
        const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID';
        const API_KEY = 'YOUR_API_KEY';
        const DISCOVERY_DOCS = ['https://sheets.googleapis.com/$discovery/rest?version=v4'];
        
        // Global variables
        let currentUser = null;
        let userData = null;
        let currentQuiz = [];
        let currentQuestion = 0;
        let score = 0;
        let selectedOption = null;
        let quizType = '';
        let answerSubmitted = false;
        let justSignedIn = false; // Flag to track if user just signed in
        let gapiLoaded = false;
        
        // Quiz questions - IGCSE Level with Interactive Types
        const preQuizQuestions = [
            {
                type: 'single',
                question: "Which of the following is the correct electron configuration of sodium?",
                options: ["[He] 2s² 2p⁶ 3s¹", "[Ne] 3s²", "[Ne] 3s¹", "[Ar] 4s¹"],
                correct: 2,
                explanation: "Sodium (Na) has atomic number 11. Its electron configuration is [Ne] 3s¹, meaning it has the same configuration as neon plus one electron in the 3s orbital."
            },
            {
                type: 'drag-drop',
                question: "Match the Group 1 element to its flame test color:",
                dragItems: ["Lithium", "Sodium", "Potassium", "Rubidium"],
                dropTargets: ["Red", "Yellow", "Lilac", "Red-violet"],
                correct: { "Lithium": "Red", "Sodium": "Yellow", "Potassium": "Lilac", "Rubidium": "Red-violet" },
                explanation: "Each Group 1 metal produces a characteristic flame color during flame tests: Lithium (red), Sodium (yellow), Potassium (lilac), and Rubidium (red-violet)."
            },
            {
                type: 'fill-blank',
                question: "Group 1 metals are stored under oil because they react with ______ and ______ in the air.",
                correct: ["oxygen", "moisture"],
                caseSensitive: false,
                explanation: "Group 1 metals are highly reactive and react with both oxygen and moisture in the air. Storing them under oil prevents these reactions."
            },
            {
                type: 'multiple',
                question: "Which of the following are properties of Group 1 metals? (Select all that apply)",
                options: [
                    "Low density", 
                    "High melting points", 
                    "Form +1 ions", 
                    "Good conductors of electricity",
                    "High ionization energy"
                ],
                correct: [0, 2, 3],
                explanation: "Group 1 metals have low density, form +1 ions, and are good conductors of electricity. They have low melting points and low ionization energy."
            },
            {
                type: 'single',
                question: "What is the main product when sodium reacts with cold water?",
                options: ["Sodium oxide and hydrogen", "Sodium hydroxide and hydrogen", "Sodium peroxide and hydrogen", "Sodium and water"],
                correct: 1,
                explanation: "Sodium reacts with cold water to produce sodium hydroxide (NaOH) and hydrogen gas (H₂). The equation is: 2Na + 2H₂O → 2NaOH + H₂."
            },
            {
                type: 'matching',
                question: "Match the reaction to the correct observation:",
                pairs: [
                    { left: "Lithium + water", right: "Fizzes steadily" },
                    { left: "Sodium + water", right: "Melts into a ball" },
                    { left: "Potassium + water", right: "Ignites with lilac flame" }
                ],
                correct: 0,
                explanation: "Lithium fizzes steadily in water, sodium melts into a ball and moves quickly, while potassium reacts violently and may ignite with a lilac flame."
            },
            {
                type: 'single',
                question: "Which Group 1 element has the lowest density and floats on water?",
                options: ["Sodium", "Lithium", "Cesium", "Rubidium"],
                correct: 1,
                explanation: "Lithium has the lowest density (0.534 g/cm³) of all Group 1 metals, which is less than water (1 g/cm³), so it floats on water."
            }
        ];
        
        const postQuizQuestions = [
            {
                type: 'single',
                question: "Which element in Group 1 forms a peroxide when burned in oxygen?",
                options: ["Lithium", "Sodium", "Potassium", "Rubidium"],
                correct: 1,
                explanation: "Sodium primarily forms the peroxide Na₂O₂ when burned in air, unlike lithium which forms the normal oxide Li₂O, and potassium/rubidium which form superoxides."
            },
            {
                type: 'drag-drop',
                question: "Match the reaction to the correct observation:",
                dragItems: [
                    "Lithium + water", 
                    "Sodium + water", 
                    "Potassium + water"
                ],
                dropTargets: [
                    "Fizzes steadily", 
                    "Melts into a ball", 
                    "Ignites with lilac flame"
                ],
                correct: { 
                    "Lithium + water": "Fizzes steadily", 
                    "Sodium + water": "Melts into a ball", 
                    "Potassium + water": "Ignites with lilac flame" 
                },
                explanation: "Lithium fizzes steadily in water, sodium melts into a ball and moves quickly, while potassium reacts violently and may ignite with a lilac flame."
            },
            {
                type: 'fill-blank',
                question: "The reactivity of Group 1 metals ______ down the group.",
                correct: ["increases"],
                caseSensitive: false,
                explanation: "Reactivity increases down Group 1 because the atomic radius increases and the outer electron is further from the nucleus, making it easier to lose."
            },
            {
                type: 'multiple',
                question: "Which of these are uses of Group 1 metals and their compounds? (Select all that apply)",
                options: [
                    "Lithium in batteries",
                    "Sodium vapor in street lights",
                    "Potassium in fertilizers",
                    "Rubidium in atomic clocks",
                    "All of the above"
                ],
                correct: [0, 1, 2, 3, 4],
                explanation: "All Group 1 metals have important uses: Lithium in batteries, sodium vapor in street lights, potassium in fertilizers, and rubidium in atomic clocks."
            },
            {
                type: 'single',
                question: "What is the formula of the superoxide formed by potassium?",
                options: ["KO", "KO₂", "K₂O", "K₂O₂"],
                correct: 1,
                explanation: "Potassium forms the superoxide KO₂ when burned in oxygen, unlike sodium which forms the peroxide Na₂O₂ and lithium which forms the oxide Li₂O."
            },
            {
                type: 'matching',
                question: "Match the element to its primary oxide type:",
                pairs: [
                    { left: "Lithium", right: "Normal oxide (Li₂O)" },
                    { left: "Sodium", right: "Peroxide (Na₂O₂)" },
                    { left: "Potassium", right: "Superoxide (KO₂)" }
                ],
                correct: 0,
                explanation: "Lithium forms the normal oxide Li₂O, sodium forms the peroxide Na₂O₂, and potassium forms the superoxide KO₂ when burned in oxygen."
            },
            {
                type: 'single',
                question: "Which statement correctly describes the trend in melting points of Group 1 metals?",
                options: [
                    "Melting point increases down the group",
                    "Melting point decreases down the group",
                    "Melting point remains constant down the group",
                    "Melting point is highest for sodium and decreases for elements above and below it"
                ],
                correct: 1,
                explanation: "The melting point of Group 1 metals decreases down the group due to weaker metallic bonding as the atomic size increases and the delocalized electrons are further from the positive nuclei."
            }
        ];
        
        // Initialize Google Sheets API
        function initGoogleSheetsApi() {
            gapi.load('client', () => {
                gapi.client.init({
                    apiKey: API_KEY,
                    discoveryDocs: DISCOVERY_DOCS,
                }).then(() => {
                    gapiLoaded = true;
                    console.log('Google Sheets API loaded');
                }, (error) => {
                    console.error('Error loading Google Sheets API:', error);
                });
            });
        }
        
        // Load Google Sheets API
        function loadGoogleSheetsApi() {
            const script = document.createElement('script');
            script.src = 'https://apis.google.com/js/api.js';
            script.onload = initGoogleSheetsApi;
            document.body.appendChild(script);
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load Google Sheets API
            loadGoogleSheetsApi();
            
            // Check if user is already logged in (from localStorage)
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    userData = JSON.parse(localStorage.getItem('userData') || '{}');
                    
                    if (userData.preQuizCompleted) {
                        showMainApp();
                    } else {
                        showPreQuizIntroduction();
                    }
                } catch (error) {
                    console.error('Error parsing saved user data:', error);
                    localStorage.removeItem('currentUser');
                    localStorage.removeItem('userData');
                    document.getElementById('landingPage').style.display = 'flex';
                }
            } else {
                document.getElementById('landingPage').style.display = 'flex';
            }
            
            // Set up login form
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!isValidEmail(email)) {
                    showToast('error', 'Invalid Email', 'Please enter a valid email address');
                    return;
                }
                
                showLoading();
                
                // Simulate login (replace with actual authentication)
                setTimeout(() => {
                    // Check if user exists in Google Sheets
                    checkUserInSheets(email).then((user) => {
                        if (user) {
                            currentUser = user;
                            userData = user;
                            
                            // Save to localStorage
                            localStorage.setItem('currentUser', JSON.stringify(currentUser));
                            localStorage.setItem('userData', JSON.stringify(userData));
                            
                            showToast('success', 'Welcome back!', 'You have been successfully signed in.');
                            closeLoginModal();
                            
                            // Set flag to indicate user just signed in
                            justSignedIn = true;
                            
                            // Track sign-in event
                            gtag('event', 'login', {
                                method: 'email'
                            });
                            
                            if (userData.preQuizCompleted) {
                                showMainApp();
                            } else {
                                showPreQuizIntroduction();
                            }
                        } else {
                            showToast('error', 'Sign in failed', 'Invalid email or password.');
                        }
                    }).catch((error) => {
                        console.error('Error checking user:', error);
                        showToast('error', 'Sign in failed', 'An error occurred. Please try again.');
                    }).finally(() => {
                        hideLoading();
                    });
                }, 1000);
            });
            
            // Set up signup form
            document.getElementById('signupForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const fullName = document.getElementById('fullName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (!isValidEmail(email)) {
                    showToast('error', 'Invalid Email', 'Please enter a valid email address');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showToast('error', 'Password Mismatch', 'Passwords do not match.');
                    return;
                }
                
                if (password.length < 6) {
                    showToast('error', 'Weak Password', 'Password must be at least 6 characters long.');
                    return;
                }
                
                showLoading();
                
                // Create new user
                const newUser = {
                    id: Date.now().toString(),
                    fullName: fullName,
                    email: email,
                    password: password, // In a real app, this should be hashed
                    points: 0,
                    currentStreak: 1,
                    lastActiveDate: new Date().toDateString(),
                    preQuizCompleted: false,
                    postQuizCompleted: false,
                    createdAt: new Date().toISOString()
                };
                
                // Save user to Google Sheets
                saveUserToSheets(newUser).then(() => {
                    currentUser = newUser;
                    userData = newUser;
                    
                    // Save to localStorage
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    localStorage.setItem('userData', JSON.stringify(userData));
                    
                    showToast('success', 'Account Created!', 'Your account has been created successfully.');
                    closeSignupModal();
                    
                    // Track sign-up event
                    gtag('event', 'sign_up', {
                        method: 'email'
                    });
                    
                    showPreQuizIntroduction();
                }).catch((error) => {
                    console.error('Error creating user:', error);
                    showToast('error', 'Sign up failed', 'An error occurred. Please try again.');
                }).finally(() => {
                    hideLoading();
                });
            });
            
            // Set up create study group form
            document.getElementById('createStudyGroupForm').addEventListener('submit', (e) => {
                e.preventDefault();
                createStudyGroup();
            });
            
            // Add click handlers for landing page buttons
            document.addEventListener('click', function(e) {
                if (e.target.matches('#landingPage .btn-primary') || e.target.closest('#landingPage .btn-primary')) {
                    showLoginModal();
                }
                if (e.target.matches('#landingPage .btn-secondary') || e.target.closest('#landingPage .btn-secondary')) {
                    showSignupModal();
                }
            });
        });
        
        // Check if user exists in Google Sheets
        async function checkUserInSheets(email) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const response = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'Users!A2:F',
                });
                
                const rows = response.result.values;
                if (rows && rows.length) {
                    for (let i = 0; i < rows.length; i++) {
                        if (rows[i][1] === email) { // Email is in column B
                            return {
                                id: rows[i][0],
                                fullName: rows[i][1],
                                email: rows[i][2],
                                points: parseInt(rows[i][3]) || 0,
                                currentStreak: parseInt(rows[i][4]) || 1,
                                preQuizCompleted: rows[i][5] === 'TRUE'
                            };
                        }
                    }
                }
                return null;
            } catch (error) {
                console.error('Error checking user in sheets:', error);
                throw error;
            }
        }
        
        // Save user to Google Sheets
        async function saveUserToSheets(user) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const values = [
                    [
                        user.id,
                        user.fullName,
                        user.email,
                        user.points,
                        user.currentStreak,
                        user.preQuizCompleted ? 'TRUE' : 'FALSE',
                        user.postQuizCompleted ? 'TRUE' : 'FALSE',
                        user.createdAt
                    ]
                ];
                
                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'Users!A2:H',
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('User saved to sheets:', response);
                return response;
            } catch (error) {
                console.error('Error saving user to sheets:', error);
                throw error;
            }
        }
        
        // Update user data in Google Sheets
        async function updateUserInSheets(user) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                // Find user row
                const findResponse = await gapi.client.sheets.spreadsheets.values.get({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'Users!A2:A',
                });
                
                const rows = findResponse.result.values;
                let rowIndex = -1;
                
                if (rows && rows.length) {
                    for (let i = 0; i < rows.length; i++) {
                        if (rows[i][0] === user.id) {
                            rowIndex = i + 2; // +2 because of header and 0-based index
                            break;
                        }
                    }
                }
                
                if (rowIndex === -1) {
                    throw new Error('User not found in sheets');
                }
                
                // Update user data
                const values = [
                    [
                        user.id,
                        user.fullName,
                        user.email,
                        user.points,
                        user.currentStreak,
                        user.preQuizCompleted ? 'TRUE' : 'FALSE',
                        user.postQuizCompleted ? 'TRUE' : 'FALSE',
                        user.createdAt
                    ]
                ];
                
                const updateResponse = await gapi.client.sheets.spreadsheets.values.update({
                    spreadsheetId: SPREADSHEET_ID,
                    range: `Users!A${rowIndex}:H${rowIndex}`,
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('User updated in sheets:', updateResponse);
                return updateResponse;
            } catch (error) {
                console.error('Error updating user in sheets:', error);
                throw error;
            }
        }
        
        // Save quiz result to Google Sheets
        async function saveQuizResultToSheets(result) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const values = [
                    [
                        result.id,
                        result.userId,
                        result.userName,
                        result.score,
                        result.totalQuestions,
                        result.percentage,
                        result.quizType,
                        result.topic,
                        result.createdAt
                    ]
                ];
                
                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'QuizResults!A2:I',
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('Quiz result saved to sheets:', response);
                return response;
            } catch (error) {
                console.error('Error saving quiz result to sheets:', error);
                throw error;
            }
        }
        
        // Save study group to Google Sheets
        async function saveStudyGroupToSheets(group) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const values = [
                    [
                        group.id,
                        group.name,
                        group.description,
                        group.goal,
                        group.maxMembers,
                        group.creatorId,
                        group.creatorName,
                        group.members.join(','),
                        group.memberCount,
                        group.createdAt
                    ]
                ];
                
                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'StudyGroups!A2:J',
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('Study group saved to sheets:', response);
                return response;
            } catch (error) {
                console.error('Error saving study group to sheets:', error);
                throw error;
            }
        }
        
        // Save comment to Google Sheets
        async function saveCommentToSheets(comment) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const values = [
                    [
                        comment.id,
                        comment.authorId,
                        comment.authorName,
                        comment.text,
                        comment.createdAt
                    ]
                ];
                
                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'Comments!A2:E',
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('Comment saved to sheets:', response);
                return response;
            } catch (error) {
                console.error('Error saving comment to sheets:', error);
                throw error;
            }
        }
        
        // Save review to Google Sheets
        async function saveReviewToSheets(review) {
            if (!gapiLoaded) {
                throw new Error('Google Sheets API not loaded');
            }
            
            try {
                const values = [
                    [
                        review.id,
                        review.userId,
                        review.userName,
                        review.rating,
                        review.text,
                        review.createdAt
                    ]
                ];
                
                const response = await gapi.client.sheets.spreadsheets.values.append({
                    spreadsheetId: SPREADSHEET_ID,
                    range: 'Reviews!A2:F',
                    valueInputOption: 'USER_ENTERED',
                    resource: {
                        values: values
                    }
                });
                
                console.log('Review saved to sheets:', response);
                return response;
            } catch (error) {
                console.error('Error saving review to sheets:', error);
                throw error;
            }
        }
        
        // Toggle sidebar (mobile)
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }
        
        // Navigate to section
        function navigateToSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(`${sectionName}-section`).style.display = 'block';
            
            // Update active nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
            
            // Track navigation event
            gtag('event', 'page_view', {
                page_title: sectionName
            });
        }
        
        // Show pre-quiz introduction page
        function showPreQuizIntroduction() {
            console.log("Showing pre-quiz introduction");
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('prequizPage').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            
            // Track pre-quiz introduction view
            gtag('event', 'page_view', {
                page_title: 'Pre-Quiz Introduction'
            });
        }
        
        // Show main application
        function showMainApp() {
            console.log("Showing main app");
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('prequizPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Update user profile
            document.getElementById('userName').textContent = userData.fullName || userData.email || 'User';
            document.getElementById('userPoints').textContent = userData.points || 0;
            document.getElementById('userStreak').textContent = userData.currentStreak || 0;
            
            // Load data
            loadStudyGroups();
            loadComments();
            loadReviews();
            
            // Add fade-in animation to elements
            document.querySelectorAll('.fade-in').forEach((el, index) => {
                el.style.animationDelay = `${index * 0.1}s`;
            });
            
            // Track main app view
            gtag('event', 'page_view', {
                page_title: 'Main App'
            });
        }
        
        // Start pre-quiz
        function startPreQuiz() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to take the quiz.');
                showLoginModal();
                return;
            }
            
            console.log("Starting pre-quiz");
            
            // Hide pre-quiz introduction page
            document.getElementById('prequizPage').style.display = 'none';
            
            currentQuiz = [...preQuizQuestions];
            quizType = 'pre';
            currentQuestion = 0;
            score = 0;
            selectedOption = null;
            answerSubmitted = false;
            showQuiz();
            
            // Track pre-quiz start
            gtag('event', 'quiz_start', {
                quiz_type: 'pre'
            });
        }
        
        // Start post-quiz
        function startPostQuiz() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to take the quiz.');
                showLoginModal();
                return;
            }
            
            currentQuiz = [...postQuizQuestions];
            quizType = 'post';
            currentQuestion = 0;
            score = 0;
            selectedOption = null;
            answerSubmitted = false;
            showQuiz();
            
            // Track post-quiz start
            gtag('event', 'quiz_start', {
                quiz_type: 'post'
            });
        }
        
        // Show quiz modal
        function showQuiz() {
            console.log("Showing quiz modal");
            document.getElementById('quizModal').classList.add('active');
            document.getElementById('quizProgress').style.display = 'block';
            document.getElementById('quizContent').style.display = 'block';
            document.getElementById('quizResults').style.display = 'none';
            
            document.getElementById('quizTitle').textContent = quizType === 'pre' ? 'Pre-Quiz' : 'Post-Quiz';
            document.getElementById('currentQuestion').textContent = currentQuestion + 1;
            document.getElementById('totalQuestions').textContent = currentQuiz.length;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
            
            loadQuestion();
        }
        
        // Load question
        function loadQuestion() {
            const question = currentQuiz[currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            // Reset buttons and feedback
            document.getElementById('submitButton').style.display = 'inline-flex';
            document.getElementById('submitButton').disabled = true;
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('feedback').classList.add('hidden');
            answerSubmitted = false;
            
            // Load options based on question type
            switch (question.type) {
                case 'single':
                case 'multiple':
                    loadMultipleChoiceQuestion(question, optionsContainer);
                    break;
                case 'drag-drop':
                    loadDragDropQuestion(question, optionsContainer);
                    break;
                case 'fill-blank':
                    loadFillBlankQuestion(question, optionsContainer);
                    break;
                case 'matching':
                    loadMatchingQuestion(question, optionsContainer);
                    break;
            }
            
            document.getElementById('prevButton').classList.toggle('hidden', currentQuestion === 0);
            
            selectedOption = null;
        }
        
        // Function to load multiple choice questions (single or multiple)
        function loadMultipleChoiceQuestion(question, container) {
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.dataset.index = index;
                
                const input = document.createElement('input');
                input.type = question.type === 'single' ? 'radio' : 'checkbox';
                input.name = 'quiz-option';
                input.id = `option-${index}`;
                input.value = index;
                
                const label = document.createElement('label');
                label.htmlFor = `option-${index}`;
                label.textContent = option;
                
                optionDiv.appendChild(input);
                optionDiv.appendChild(label);
                
                optionDiv.onclick = () => selectOption(index, question.type);
                container.appendChild(optionDiv);
            });
        }
        
        // Function to load drag and drop questions
        function loadDragDropQuestion(question, container) {
            const dragItemsContainer = document.createElement('div');
            dragItemsContainer.className = 'drag-items-container mb-4';
            
            question.dragItems.forEach((item, index) => {
                const dragItem = document.createElement('div');
                dragItem.className = 'drag-item';
                dragItem.draggable = true;
                dragItem.textContent = item;
                dragItem.dataset.index = index;
                
                dragItem.addEventListener('dragstart', handleDragStart);
                dragItem.addEventListener('dragend', handleDragEnd);
                
                dragItemsContainer.appendChild(dragItem);
            });
            
            const dropTargetsContainer = document.createElement('div');
            dropTargetsContainer.className = 'drop-targets-container';
            
            question.dropTargets.forEach((target, index) => {
                const dropTarget = document.createElement('div');
                dropTarget.className = 'drop-target';
                dropTarget.textContent = target;
                dropTarget.dataset.index = index;
                
                dropTarget.addEventListener('dragover', handleDragOver);
                dropTarget.addEventListener('drop', handleDrop);
                
                dropTargetsContainer.appendChild(dropTarget);
            });
            
            container.appendChild(dragItemsContainer);
            container.appendChild(dropTargetsContainer);
            
            // Create a mapping object to store user's answers
            window.dragDropAnswers = {};
        }
        
        // Function to load fill in the blank questions
        function loadFillBlankQuestion(question, container) {
            const blankContainer = document.createElement('div');
            blankContainer.className = 'blank-container';
            
            // Split the question by blanks
            const parts = question.question.split('____');
            
            parts.forEach((part, index) => {
                if (part) {
                    const textSpan = document.createElement('span');
                    textSpan.textContent = part;
                    blankContainer.appendChild(textSpan);
                }
                
                // Add input field for each blank except the last one
                if (index < parts.length - 1) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'blank-input';
                    input.dataset.blankIndex = index;
                    input.addEventListener('input', () => {
                        document.getElementById('submitButton').disabled = false;
                    });
                    blankContainer.appendChild(input);
                }
            });
            
            container.appendChild(blankContainer);
            
            // Create an array to store user's answers
            window.fillBlankAnswers = [];
        }
        
        // Function to load matching questions
        function loadMatchingQuestion(question, container) {
            const matchingContainer = document.createElement('div');
            matchingContainer.className = 'matching-container';
            
            const leftColumn = document.createElement('div');
            leftColumn.className = 'matching-column';
            
            const rightColumn = document.createElement('div');
            rightColumn.className = 'matching-column';
            
            question.pairs.forEach((pair, index) => {
                const leftItem = document.createElement('div');
                leftItem.className = 'matching-item';
                leftItem.textContent = pair.left;
                leftItem.dataset.index = index;
                leftColumn.appendChild(leftItem);
                
                const rightItem = document.createElement('div');
                rightItem.className = 'matching-item';
                rightItem.textContent = pair.right;
                rightItem.dataset.index = index;
                rightColumn.appendChild(rightItem);
            });
            
            matchingContainer.appendChild(leftColumn);
            matchingContainer.appendChild(rightColumn);
            container.appendChild(matchingContainer);
            
            // Create an array to store user's matches
            window.matchingAnswers = [];
            
            // Add event listeners for matching
            const leftItems = leftColumn.querySelectorAll('.matching-item');
            const rightItems = rightColumn.querySelectorAll('.matching-item');
            
            leftItems.forEach(item => {
                item.addEventListener('click', () => handleMatchingSelect(item, 'left'));
            });
            
            rightItems.forEach(item => {
                item.addEventListener('click', () => handleMatchingSelect(item, 'right'));
            });
        }
        
        // Functions to handle drag and drop
        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.index);
            e.target.classList.add('dragging');
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.target.classList.add('drag-over');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            
            const draggedIndex = e.dataTransfer.getData('text/plain');
            const targetIndex = e.target.dataset.index;
            
            // Store the mapping
            window.dragDropAnswers[draggedIndex] = targetIndex;
            
            // Visual feedback
            e.target.textContent = currentQuiz[currentQuestion].dragItems[draggedIndex] + ' → ' + 
                          currentQuiz[currentQuestion].dropTargets[targetIndex];
            
            document.getElementById('submitButton').disabled = false;
        }
        
        // Function to handle matching selection
        let selectedMatchingItem = null;
        
        function handleMatchingSelect(item, column) {
            if (selectedMatchingItem === null) {
                // First selection
                selectedMatchingItem = { item, column };
                item.classList.add('selected');
            } else if (selectedMatchingItem.column === column) {
                // Deselect if clicking same item
                selectedMatchingItem.item.classList.remove('selected');
                selectedMatchingItem = null;
            } else {
                // Match items
                const firstIndex = parseInt(selectedMatchingItem.item.dataset.index);
                const secondIndex = parseInt(item.dataset.index);
                
                // Store the match
                window.matchingAnswers[firstIndex] = secondIndex;
                
                // Visual feedback
                selectedMatchingItem.item.classList.remove('selected');
                selectedMatchingItem.item.classList.add('matched');
                item.classList.add('matched');
                
                selectedMatchingItem = null;
                document.getElementById('submitButton').disabled = false;
            }
        }
        
        // Updated selectOption function to handle multiple selection
        function selectOption(index, type) {
            if (answerSubmitted) return;
            
            const options = document.querySelectorAll('.quiz-option');
            
            if (type === 'single') {
                // Remove previous selection
                options.forEach(option => {
                    option.classList.remove('selected');
                    const input = option.querySelector('input');
                    if (input) input.checked = false;
                });
                
                // Add selection to clicked option
                options[index].classList.add('selected');
                const input = options[index].querySelector('input');
                if (input) input.checked = true;
                
                selectedOption = index;
            } else {
                // Multiple selection
                const input = options[index].querySelector('input');
                input.checked = !input.checked;
                
                if (input.checked) {
                    options[index].classList.add('selected');
                    if (!selectedOption) selectedOption = [];
                    selectedOption.push(index);
                } else {
                    options[index].classList.remove('selected');
                    if (selectedOption && Array.isArray(selectedOption)) {
                        selectedOption = selectedOption.filter(i => i !== index);
                        if (selectedOption.length === 0) selectedOption = null;
                    }
                }
            }
            
            // Enable submit button
            document.getElementById('submitButton').disabled = false;
        }
        
        // Updated submitAnswer function to handle different question types
        function submitAnswer() {
            if (answerSubmitted) return;
            
            const question = currentQuiz[currentQuestion];
            let isCorrect = false;
            const feedback = document.getElementById('feedback');
            
            switch (question.type) {
                case 'single':
                    isCorrect = selectedOption === question.correct;
                    break;
                case 'multiple':
                    if (!selectedOption || !Array.isArray(selectedOption)) {
                        isCorrect = false;
                    } else {
                        // Check if all selected options are correct and all correct options are selected
                        const correctSet = new Set(question.correct);
                        const selectedSet = new Set(selectedOption);
                        isCorrect = selectedOption.length === question.correct.length && 
                                     selectedOption.every(opt => correctSet.has(opt));
                    }
                    break;
                case 'drag-drop':
                    // Check if all drag items are correctly matched
                    isCorrect = Object.keys(window.dragDropAnswers).length === question.dragItems.length &&
                                 Object.entries(window.dragDropAnswers).every(([dragIndex, dropIndex]) => {
                                     const dragItem = question.dragItems[dragIndex];
                                     const dropTarget = question.dropTargets[dropIndex];
                                     return question.correct[dragItem] === dropTarget;
                                 });
                    break;
                case 'fill-blank':
                    // Check if all blanks are filled correctly
                    const blankInputs = document.querySelectorAll('.blank-input');
                    isCorrect = Array.from(blankInputs).every((input, index) => {
                        const userAnswer = input.value.trim().toLowerCase();
                        const correctAnswers = Array.isArray(question.correct) ? 
                            question.correct.map(a => a.toLowerCase()) : 
                            [question.correct.toLowerCase()];
                        return correctAnswers.includes(userAnswer);
                    });
                    break;
                case 'matching':
                    // Check if all matches are correct
                    isCorrect = window.matchingAnswers.length === question.pairs.length &&
                                 window.matchingAnswers.every((rightIndex, leftIndex) => {
                                     return leftIndex === rightIndex; // Assuming correct pairs are in order
                                 });
                    break;
            }
            
            if (isCorrect) {
                feedback.className = 'mb-4 p-3 rounded-lg bg-green-100 text-green-800 text-sm';
                feedback.textContent = 'Correct! ' + question.explanation;
                score++;
                
                // Award points
                awardPoints(10, 'Correct answer');
                
                // Track correct answer
                gtag('event', 'quiz_answer', {
                    quiz_type: quizType,
                    question_number: currentQuestion + 1,
                    is_correct: true
                });
            } else {
                feedback.className = 'mb-4 p-3 rounded-lg bg-red-100 text-red-800 text-sm';
                feedback.textContent = 'Incorrect. ' + question.explanation;
                
                // Track incorrect answer
                gtag('event', 'quiz_answer', {
                    quiz_type: quizType,
                    question_number: currentQuestion + 1,
                    is_correct: false
                });
            }
            
            feedback.classList.remove('hidden');
            document.getElementById('submitButton').style.display = 'none';
            document.getElementById('nextButton').classList.remove('hidden');
            document.getElementById('currentScore').textContent = score;
            
            // Mark answer as submitted
            answerSubmitted = true;
            
            // Show correct answers for visual feedback
            if (question.type === 'single' || question.type === 'multiple') {
                const options = document.querySelectorAll('.quiz-option');
                
                if (question.type === 'single') {
                    options[question.correct].classList.add('correct');
                    if (selectedOption !== null && selectedOption !== question.correct) {
                        options[selectedOption].classList.add('incorrect');
                    }
                } else {
                    question.correct.forEach(correctIndex => {
                        options[correctIndex].classList.add('correct');
                    });
                    
                    if (selectedOption && Array.isArray(selectedOption)) {
                        selectedOption.forEach(selectedIndex => {
                            if (!question.correct.includes(selectedIndex)) {
                                options[selectedIndex].classList.add('incorrect');
                            }
                        });
                    }
                }
            }
        }
        
        // Next question
        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion >= currentQuiz.length) {
                showResults();
                return;
            }
            
            document.getElementById('currentQuestion').textContent = currentQuestion + 1;
            document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
            loadQuestion();
        }
        
        // Previous question
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                document.getElementById('currentQuestion').textContent = currentQuestion + 1;
                document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
                loadQuestion();
            }
        }
        
        // Show quiz results
        function showResults() {
            document.getElementById('quizProgress').style.display = 'none';
            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            
            const percentage = Math.round((score / currentQuiz.length) * 100);
            document.getElementById('finalScore').textContent = `${score}/${currentQuiz.length}`;
            
            let message = '';
            if (percentage >= 80) {
                message = 'Excellent! You have a strong understanding of Group 1 elements.';
            } else if (percentage >= 60) {
                message = 'Good job! You have a solid foundation to build upon.';
            } else if (percentage >= 40) {
                message = 'Not bad! Pay attention to the learning materials to improve.';
            } else {
                message = 'Keep practicing! Review the materials carefully.';
            }
            
            document.getElementById('scoreMessage').textContent = message;
            
            // Save quiz result
            saveQuizResult(score, currentQuiz.length, quizType);
            
            // Track quiz completion
            gtag('event', 'quiz_complete', {
                quiz_type: quizType,
                score: score,
                total_questions: currentQuiz.length,
                percentage: percentage
            });
            
            // Show appropriate actions
            if (quizType === 'pre') {
                document.getElementById('postQuizActions').style.display = 'block';
                document.getElementById('finalActions').style.display = 'none';
            } else {
                document.getElementById('postQuizActions').style.display = 'none';
                document.getElementById('finalActions').style.display = 'block';
            }
        }
        
        // Complete pre-quiz and unlock main content
        function completePreQuiz() {
            if (!currentUser) return;
            
            console.log("Completing pre-quiz for user:", currentUser.id);
            
            // Update user data
            userData.preQuizCompleted = true;
            userData.preQuizScore = score;
            userData.preQuizDate = new Date().toISOString();
            
            // Save to localStorage
            localStorage.setItem('userData', JSON.stringify(userData));
            
            // Update user in Google Sheets
            updateUserInSheets(userData).then(() => {
                console.log("Pre-quiz completed, showing main app");
                
                // Award points for completing pre-quiz
                awardPoints(50, 'Completed pre-quiz');
                
                // Close quiz modal
                closeQuiz();
                
                // Show main app
                showMainApp();
                
                showToast('success', 'Pre-Quiz Complete!', 'You can now access the learning materials.');
            }).catch((error) => {
                console.error("Error updating pre-quiz status:", error);
                showToast('error', 'Error', 'Failed to save pre-quiz results.');
            });
        }
        
        // Save quiz result
        function saveQuizResult(score, totalQuestions, quizType) {
            const result = {
                id: Date.now().toString(),
                userId: currentUser.id,
                userName: userData.fullName || userData.email,
                score: score,
                totalQuestions: totalQuestions,
                percentage: Math.round((score / totalQuestions) * 100),
                quizType: quizType,
                topic: 'Group 1 - Alkali Metals',
                createdAt: new Date().toISOString()
            };
            
            saveQuizResultToSheets(result).catch((error) => {
                console.error("Error saving quiz result:", error);
            });
        }
        
        // Close quiz
        function closeQuiz() {
            console.log("Closing quiz modal");
            document.getElementById('quizModal').classList.remove('active');
            
            // If user hasn't completed pre-quiz, show pre-quiz introduction
            if (currentUser && userData && !userData.preQuizCompleted) {
                showPreQuizIntroduction();
            }
        }
        
        // Award points to user
        function awardPoints(points, reason) {
            if (!currentUser || !userData) return;
            
            // Update user data
            userData.points = (userData.points || 0) + points;
            userData.lastActiveDate = new Date().toDateString();
            
            // Update streak
            const today = new Date().toDateString();
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayString = yesterday.toDateString();
            
            if (userData.lastActiveDate === yesterdayString) {
                userData.currentStreak = (userData.currentStreak || 1) + 1;
            } else if (userData.lastActiveDate !== today) {
                userData.currentStreak = 1;
            }
            
            // Save to localStorage
            localStorage.setItem('userData', JSON.stringify(userData));
            
            // Update user in Google Sheets
            updateUserInSheets(userData).catch((error) => {
                console.error("Error updating user data:", error);
            });
            
            // Update UI
            document.getElementById('userPoints').textContent = userData.points;
            document.getElementById('userStreak').textContent = userData.currentStreak;
            
            showToast('success', 'Points Awarded', `+${points} points for ${reason}`);
            
            // Track points awarded
            gtag('event', 'points_awarded', {
                points: points,
                reason: reason
            });
        }
        
        // Load study groups
        function loadStudyGroups() {
            const container = document.getElementById('studyGroupsContainer');
            container.innerHTML = '<div class="spinner"></div>';
            
            // Simulate loading from Google Sheets
            setTimeout(() => {
                container.innerHTML = '<p class="text-gray-500 text-center">No study groups yet. Create one!</p>';
            }, 1000);
        }
        
        // Create study group
        function createStudyGroup() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to create study groups.');
                return;
            }
            
            const name = document.getElementById('groupName').value;
            const description = document.getElementById('groupDescription').value;
            const goal = document.getElementById('groupGoal').value;
            const maxMembers = parseInt(document.getElementById('groupMaxMembers').value);
            
            showLoading();
            
            const group = {
                id: Date.now().toString(),
                name: name,
                description: description,
                goal: goal,
                maxMembers: maxMembers,
                creatorId: currentUser.id,
                creatorName: userData.fullName || userData.email,
                members: [currentUser.id],
                memberCount: 1,
                createdAt: new Date().toISOString()
            };
            
            saveStudyGroupToSheets(group).then(() => {
                showToast('success', 'Group Created', 'Your study group has been created successfully.');
                closeCreateStudyGroup();
                document.getElementById('createStudyGroupForm').reset();
                
                // Award points
                awardPoints(20, 'Created study group');
                
                // Track study group creation
                gtag('event', 'study_group_created');
                
                // Reload study groups
                loadStudyGroups();
            }).catch((error) => {
                console.error("Error creating study group:", error);
                showToast('error', 'Error', 'Failed to create study group.');
            }).finally(() => {
                hideLoading();
            });
        }
        
        // Join study group
        function joinStudyGroup(groupId) {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to join study groups.');
                return;
            }
            
            showToast('success', 'Joined Group', 'You have successfully joined the study group.');
            
            // Award points
            awardPoints(10, 'Joined study group');
            
            // Track study group join
            gtag('event', 'study_group_joined');
        }
        
        // Leave study group
        function leaveStudyGroup(groupId) {
            showToast('success', 'Left Group', 'You have successfully left the study group.');
        }
        
        // Load comments
        function loadComments() {
            const container = document.getElementById('commentsContainer');
            container.innerHTML = '<div class="spinner"></div>';
            
            // Simulate loading from Google Sheets
            setTimeout(() => {
                container.innerHTML = '<p class="text-gray-500 text-center">No comments yet. Be the first to comment!</p>';
            }, 1000);
        }
        
        // Add comment
        function addComment() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to post comments.');
                return;
            }
            
            const commentInput = document.getElementById('commentInput');
            const commentText = commentInput.value.trim();
            
            if (!commentText) {
                showToast('error', 'Empty Comment', 'Please enter a comment before posting.');
                return;
            }
            
            showLoading();
            
            const comment = {
                id: Date.now().toString(),
                authorId: currentUser.id,
                authorName: userData.fullName || userData.email,
                text: commentText,
                createdAt: new Date().toISOString()
            };
            
            saveCommentToSheets(comment).then(() => {
                commentInput.value = '';
                showToast('success', 'Comment Posted', 'Your comment has been posted successfully.');
                
                // Award points
                awardPoints(5, 'Comment posted');
                
                // Track comment posted
                gtag('event', 'comment_posted');
                
                // Reload comments
                loadComments();
            }).catch((error) => {
                console.error("Error adding comment:", error);
                showToast('error', 'Error', 'Failed to post comment.');
            }).finally(() => {
                hideLoading();
            });
        }
        
        // Load reviews
        function loadReviews() {
            const container = document.getElementById('reviewList');
            container.innerHTML = '<div class="spinner"></div>';
            
            // Simulate loading from Google Sheets
            setTimeout(() => {
                container.innerHTML = '<p class="text-gray-500 text-center">No reviews yet. Be the first to review!</p>';
            }, 1000);
        }
        
        // Submit feedback
        function submitFeedback(type) {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to submit feedback.');
                return;
            }
            
            // Update UI
            const feedbackButtons = document.querySelectorAll('.feedback-btn');
            feedbackButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.closest('.feedback-btn').classList.add('active');
            
            showToast('success', 'Feedback Submitted', 'Thank you for your feedback!');
            
            // Track feedback
            gtag('event', 'feedback_submitted', {
                feedback_type: type
            });
        }
        
        // Submit review
        function submitReview() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to submit a review.');
                return;
            }
            
            const reviewText = document.getElementById('reviewText').value.trim();
            
            if (!reviewText) {
                showToast('error', 'Empty Review', 'Please enter a review before submitting.');
                return;
            }
            
            showLoading();
            
            // Get rating from active feedback button
            let rating = 0;
            const activeFeedbackBtn = document.querySelector('.feedback-btn.active');
            if (activeFeedbackBtn) {
                rating = activeFeedbackBtn.querySelector('i').classList.contains('fa-thumbs-up') ? 5 : 1;
            }
            
            const review = {
                id: Date.now().toString(),
                userId: currentUser.id,
                userName: userData.fullName || userData.email,
                rating: rating,
                text: reviewText,
                createdAt: new Date().toISOString()
            };
            
            saveReviewToSheets(review).then(() => {
                document.getElementById('reviewText').value = '';
                
                // Reset feedback buttons
                const feedbackButtons = document.querySelectorAll('.feedback-btn');
                feedbackButtons.forEach(btn => {
                    btn.classList.remove('active');
                });
                
                showToast('success', 'Review Submitted', 'Your review has been submitted successfully.');
                
                // Award points
                awardPoints(15, 'Review submitted');
                
                // Track review submitted
                gtag('event', 'review_submitted', {
                    rating: rating
                });
                
                // Reload reviews
                loadReviews();
            }).catch((error) => {
                console.error("Error submitting review:", error);
                showToast('error', 'Error', 'Failed to submit review.');
            }).finally(() => {
                hideLoading();
            });
        }
        
        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        // Modal functions
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }
        
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
        }
        
        function showSignupModal() {
            document.getElementById('signupModal').classList.add('active');
        }
        
        function closeSignupModal() {
            document.getElementById('signupModal').classList.remove('active');
        }
        
        function switchToSignup() {
            closeLoginModal();
            showSignupModal();
        }
        
        function switchToLogin() {
            closeSignupModal();
            showLoginModal();
        }
        
        function showCreateStudyGroup() {
            document.getElementById('createStudyGroupModal').classList.add('active');
        }
        
        function closeCreateStudyGroup() {
            document.getElementById('createStudyGroupModal').classList.remove('active');
        }
        
        // Sign out
        function signOut() {
            currentUser = null;
            userData = null;
            
            // Clear localStorage
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userData');
            
            showToast('success', 'Signed out', 'You have been successfully signed out.');
            document.getElementById('landingPage').style.display = 'flex';
            document.getElementById('prequizPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'none';
            
            // Track sign out
            gtag('event', 'sign_out');
        }
        
        // Utility functions
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }
        
        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
        
        // Toast notification
        function showToast(type, title, message) {
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'fa-info-circle';
            if (type === 'success') icon = 'fa-check-circle';
            else if (type === 'error') icon = 'fa-exclamation-circle';
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="toast-message">
                    <div class="toast-title">${title}</div>
                    <div class="toast-description">${message}</div>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Hide toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>
