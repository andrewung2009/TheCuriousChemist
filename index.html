<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemistry Mastery - Group 1 Alkali Metals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 260px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }
        
        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-nav {
            padding: 1rem 0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            color: #4b5563;
            text-decoration: none;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
            border-left-color: #4f46e5;
        }
        
        .nav-item.active {
            background: rgba(79, 70, 229, 0.1);
            color: #4f46e5;
            border-left-color: #4f46e5;
            font-weight: 600;
        }
        
        .nav-item i {
            margin-right: 0.75rem;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem 1.5rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .main-content {
            margin-left: 260px;
            padding: 2rem;
            min-height: 100vh;
        }
        
        .menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 101;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        /* Learning Path Styles */
        .learning-path {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem 0;
            position: relative;
        }
        
        .learning-path::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            z-index: 0;
        }
        
        .path-step {
            background: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .path-step.active {
            background: #4f46e5;
            color: white;
            transform: scale(1.1);
        }
        
        .path-step.completed {
            background: #10b981;
            color: white;
        }
        
        .path-step.locked {
            background: #9ca3af;
            color: white;
        }
        
        .path-label {
            position: absolute;
            bottom: -30px;
            white-space: nowrap;
            font-size: 0.875rem;
            font-weight: 500;
            color: white;
        }
        
        /* Content Cards */
        .content-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #4f46e5;
        }
        
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .content-card.locked {
            opacity: 0.6;
            filter: grayscale(100%);
            cursor: not-allowed;
        }
        
        .content-card.locked:hover {
            transform: none;
        }
        
        /* Element Cards */
        .element-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .element-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .element-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
        }
        
        .element-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .element-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            object-fit: cover;
            border: 3px solid #e5e7eb;
        }
        
        /* Tab Styles */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: 500;
            color: #6b7280;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .tab::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #4f46e5;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .tab.active {
            color: #4f46e5;
        }
        
        .tab.active::after {
            transform: scaleX(1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Quiz Styles */
        .quiz-option {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            margin: 0.75rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .quiz-option:hover {
            border-color: #4f46e5;
            background: #f3f4f6;
        }
        
        .quiz-option.selected {
            border-color: #4f46e5;
            background: #eef2ff;
        }
        
        .quiz-option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }
        
        .quiz-option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            transition: width 0.3s ease;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
        }
        
        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #4b5563;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        /* Lock Overlay */
        .lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 1rem;
            color: white;
            font-size: 3rem;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            display: flex;
            align-items: center;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast-icon {
            margin-right: 0.75rem;
            font-size: 1.25rem;
        }
        
        .toast.success .toast-icon {
            color: #10b981;
        }
        
        .toast.error .toast-icon {
            color: #ef4444;
        }
        
        .toast.info .toast-icon {
            color: #3b82f6;
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Landing Page Styles */
        .landing-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .landing-card {
            background: white;
            border-radius: 2rem;
            padding: 3rem;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .landing-icon {
            font-size: 4rem;
            color: #4f46e5;
            margin-bottom: 1rem;
        }
        
        .landing-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .landing-subtitle {
            font-size: 1.25rem;
            color: #6b7280;
            margin-bottom: 2rem;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .feature-card {
            padding: 1.5rem;
            border-radius: 1rem;
            background: #f9fafb;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2rem;
            color: #4f46e5;
            margin-bottom: 0.5rem;
        }
        
        /* Pre-Quiz Introduction Styles */
        .prequiz-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .prequiz-card {
            background: white;
            border-radius: 2rem;
            padding: 3rem;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .prequiz-icon {
            font-size: 4rem;
            color: #4f46e5;
            margin-bottom: 1rem;
        }
        
        .prequiz-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .prequiz-subtitle {
            font-size: 1.25rem;
            color: #6b7280;
            margin-bottom: 2rem;
        }
        
        .support-message {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 2rem 0;
            text-align: left;
        }
        
        .support-message h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.5rem;
        }
        
        .support-message p {
            color: #1e3a8a;
            line-height: 1.6;
        }
        
        /* Study Group Styles */
        .study-group-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .study-group-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .member-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.75rem;
            margin-right: -10px;
            border: 2px solid white;
        }
        
        /* Comment Styles */
        .comment-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .comment {
            background: #f9fafb;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #4f46e5;
        }
        
        .comment-author {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }
        
        .comment-text {
            color: #4b5563;
        }
        
        .comment-form {
            display: flex;
            margin-top: 1rem;
            gap: 0.5rem;
        }
        
        .comment-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }
        
        .comment-submit {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .comment-submit:hover {
            background: #4338ca;
        }
        
        /* Highlight Box */
        .highlight-box {
            background: #f0f9ff;
            border-left: 4px solid #0ea5e9;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
        
        .highlight-box h4 {
            color: #0c4a6e;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .highlight-box p {
            color: #075985;
        }
        
        /* Equation Box */
        .equation-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .equation-box .equation {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0.5rem 0;
        }
        
        /* Key Point Box */
        .key-point {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
        
        .key-point h4 {
            color: #92400e;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .key-point p {
            color: #78350f;
        }
        
        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .comparison-table th {
            background: #4f46e5;
            color: white;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
        }
        
        .comparison-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f9fafb;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .landing-title, .prequiz-title {
                font-size: 2rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .element-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .learning-path {
                flex-direction: column;
                gap: 2rem;
            }
            
            .learning-path::before {
                width: 4px;
                height: 100%;
                top: 0;
                left: 50%;
                right: auto;
                transform: translateX(-50%);
            }
            
            .comparison-table {
                font-size: 0.875rem;
            }
            
            .comparison-table th, .comparison-table td {
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Landing Page (shown when user hasn't signed in) -->
    <div id="landingPage" class="landing-container" style="display: none;">
        <div class="landing-card fade-in">
            <div class="landing-icon">
                <i class="fas fa-atom"></i>
            </div>
            <h1 class="landing-title">Chemistry Mastery</h1>
            <p class="landing-subtitle">Master Group 1 Alkali Metals through Interactive Learning</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <h3 class="font-semibold">Pre-Assessment</h3>
                    <p class="text-sm text-gray-600">Test your current knowledge</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <h3 class="font-semibold">Interactive Content</h3>
                    <p class="text-sm text-gray-600">Learn through engaging materials</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 class="font-semibold">Collaborative Learning</h3>
                    <p class="text-sm text-gray-600">Study with peers</p>
                </div>
            </div>
            
            <div class="mt-8">
                <p class="text-lg font-semibold text-gray-700 mb-4">Your Learning Journey</p>
                <div class="learning-path">
                    <div class="path-step active">
                        <i class="fas fa-play"></i>
                        <span class="path-label">Pre-Quiz</span>
                    </div>
                    <div class="path-step locked">
                        <i class="fas fa-lock"></i>
                        <span class="path-label">Learn</span>
                    </div>
                    <div class="path-step locked">
                        <i class="fas fa-lock"></i>
                        <span class="path-label">Post-Quiz</span>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 space-y-4">
                <button onclick="showLoginModal()" class="btn btn-primary w-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In to Begin
                </button>
                <button onclick="signInWithGoogle()" class="btn btn-secondary w-full">
                    <i class="fab fa-google"></i>
                    Continue with Google
                </button>
            </div>
        </div>
    </div>
    
    <!-- Pre-Quiz Introduction Page (shown after sign-in) -->
    <div id="prequizPage" class="prequiz-container" style="display: none;">
        <div class="prequiz-card fade-in">
            <div class="prequiz-icon">
                <i class="fas fa-clipboard-list"></i>
            </div>
            <h1 class="prequiz-title">Pre-Assessment Quiz</h1>
            <p class="prequiz-subtitle">Let's check your current knowledge of Group 1 Alkali Metals</p>
            
            <div class="support-message">
                <h3><i class="fas fa-lightbulb mr-2"></i>Before You Begin</h3>
                <p>This quiz helps us understand your current knowledge level. Don't worry if you don't know all the answers - this is just a starting point! Take your time, read each question carefully, and do your best. Your results will help us personalize your learning experience.</p>
            </div>
            
            <div class="bg-blue-50 p-4 rounded-lg mb-6">
                <div class="flex items-center mb-2">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    <h3 class="font-semibold text-blue-800">Quiz Details</h3>
                </div>
                <ul class="text-left text-blue-700 space-y-1">
                    <li>• 7 multiple-choice questions</li>
                    <li>• No time limit</li>
                    <li>• Immediate feedback on answers</li>
                    <li>• Results saved to your profile</li>
                </ul>
            </div>
            
            <div class="mt-8">
                <button onclick="startPreQuiz()" class="btn btn-primary w-full">
                    <i class="fas fa-play mr-2"></i>
                    Start Pre-Quiz
                </button>
            </div>
        </div>
    </div>
    
    <!-- Main App (shown after pre-quiz completion) -->
    <div id="mainApp" style="display: none;">
        <!-- Menu Toggle Button (Mobile) -->
        <button class="menu-toggle" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="flex items-center">
                    <i class="fas fa-atom text-indigo-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold text-gray-800">Chemistry Mastery</h1>
                </div>
                <p class="text-sm text-gray-600 mt-1">Group 1 - Alkali Metals</p>
            </div>
            
            <div class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="navigateToSection('overview')">
                    <i class="fas fa-home"></i>
                    <span>Overview</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('elements')">
                    <i class="fas fa-th"></i>
                    <span>Elements</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('properties')">
                    <i class="fas fa-flask"></i>
                    <span>Properties</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('reactions')">
                    <i class="fas fa-vial"></i>
                    <span>Reactions</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('study-groups')">
                    <i class="fas fa-users"></i>
                    <span>Study Groups</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('discussion')">
                    <i class="fas fa-comments"></i>
                    <span>Discussion</span>
                </a>
                <a href="#" class="nav-item" onclick="navigateToSection('quiz')">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Final Quiz</span>
                </a>
            </div>
            
            <div class="sidebar-footer">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center">
                        <div class="bg-indigo-100 rounded-full p-2 mr-2">
                            <i class="fas fa-coins text-indigo-600"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700"><span id="userPoints">0</span> pts</span>
                    </div>
                    <div class="flex items-center">
                        <div class="bg-orange-100 rounded-full p-2 mr-2">
                            <i class="fas fa-fire text-orange-500"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700"><span id="userStreak">0</span></span>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">Signed in as:</span>
                    <span class="text-sm font-medium text-gray-800" id="userName">User</span>
                </div>
                <button onclick="signOut()" class="btn btn-secondary w-full mt-3 text-sm">
                    <i class="fas fa-sign-out-alt mr-1"></i>
                    Logout
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Learning Path -->
            <div class="mb-6">
                <div class="learning-path">
                    <div class="path-step completed">
                        <i class="fas fa-check"></i>
                        <span class="path-label">Pre-Quiz</span>
                    </div>
                    <div class="path-step active">
                        <i class="fas fa-book-open"></i>
                        <span class="path-label">Learn</span>
                    </div>
                    <div class="path-step">
                        <i class="fas fa-graduation-cap"></i>
                        <span class="path-label">Post-Quiz</span>
                    </div>
                </div>
            </div>
            
            <!-- Overview Section -->
            <div id="overview-section" class="content-section">
                <!-- Hero Section -->
                <div class="text-center mb-8 fade-in">
                    <h2 class="text-3xl font-bold text-white mb-3">Group 1: The Alkali Metals</h2>
                    <p class="text-lg text-white/90 max-w-2xl mx-auto">
                        Explore the most reactive metals in the periodic table
                    </p>
                </div>
                
                <!-- Introduction -->
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-info-circle mr-2 text-indigo-600"></i>
                        Introduction
                    </h3>
                    <p class="text-gray-700 mb-4">
                        Group 1 elements, known as the alkali metals, occupy the first column of the periodic table. 
                        They consist of lithium (Li), sodium (Na), potassium (K), rubidium (Rb), cesium (Cs), and francium (Fr). 
                        These elements share similar properties because they all have <strong>one electron in their outer shell</strong>, 
                        which they readily lose to form +1 ions.
                    </p>
                    
                    <div class="highlight-box">
                        <h4>Electron Configuration</h4>
                        <p>All Group 1 elements have an electron number configuration that ends with a single electron in the outermost shell, such as lithium 2,1, sodium 2,8,1, and potassium 2,8,8,1; this single valence electron is easily lost, which makes these elements highly reactive metals.</p>
                    </div>
                    
                    <p class="text-gray-700 mt-4">
                        Alkali metals are soft, shiny metals with low densities and low melting points. 
                        Their reactivity increases as you move down the group. Due to their high reactivity, 
                        they are never found free in nature but always occur in compounds, often as chlorides, 
                        carbonates, or sulfates.
                    </p>
                </div>
                
                <!-- Key Characteristics -->
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-star mr-2 text-indigo-600"></i>
                        Key Characteristics
                    </h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">Physical Properties</h4>
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Soft metals that can be cut with a knife</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Low density - lithium floats on water</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Low melting and boiling points</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Good conductors of heat and electricity</span>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">Chemical Properties</h4>
                            <ul class="space-y-2 text-gray-600">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Highly reactive with one valence electron</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Form +1 ions by losing their valence electron</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Reactivity increases down the group</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <span>Never found free in nature</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="key-point mt-4">
                        <h4>Remember</h4>
                        <p>Group 1 metals are so reactive they must be stored under oil to prevent reaction with air and moisture!</p>
                    </div>
                </div>
                
                <!-- Applications -->
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-industry mr-2 text-indigo-600"></i>
                        Real-World Applications
                    </h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">Lithium</h4>
                            <p class="text-sm text-blue-600">Used in batteries for phones and electric vehicles, glass production, and as a medication for bipolar disorder</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">Sodium</h4>
                            <p class="text-sm text-green-600">Essential for life (nerve function), used in street lights (sodium vapor lamps), and food preservation (salt)</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">Potassium</h4>
                            <p class="text-sm text-purple-600">Vital for plants (fertilizers), essential for nerve and muscle function in animals, used in soap production</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Elements Section -->
            <div id="elements-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-th mr-2 text-indigo-600"></i>
                        Meet the Elements
                    </h3>
                    <div class="element-grid">
                        <div class="element-card">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/e/ed/Lithiumcut_cropped.jpg" alt="Lithium" class="element-image">
                            <h4 class="font-bold text-lg">Lithium (Li)</h4>
                            <p class="text-sm text-gray-600">Atomic: 3</p>
                        </div>
                        <div class="element-card">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/2/27/Na_%28Sodium%29.jpg" alt="Sodium" class="element-image">
                            <h4 class="font-bold text-lg">Sodium (Na)</h4>
                            <p class="text-sm text-gray-600">Atomic: 11</p>
                        </div>
                        <div class="element-card">
                            <img src="https://cdn.britannica.com/77/131177-050-79292189/fragments-Potassium-metal.jpg" alt="Potassium" class="element-image">
                            <h4 class="font-bold text-lg">Potassium (K)</h4>
                            <p class="text-sm text-gray-600">Atomic: 19</p>
                        </div>
                        <div class="element-card">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/c/c9/Rb5.JPG" alt="Rubidium" class="element-image">
                            <h4 class="font-bold text-lg">Rubidium (Rb)</h4>
                            <p class="text-sm text-gray-600">Atomic: 37</p>
                        </div>
                        <div class="element-card">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3d/Cesium.jpg" alt="Cesium" class="element-image">
                            <h4 class="font-bold text-lg">Cesium (Cs)</h4>
                            <p class="text-sm text-gray-600">Atomic: 55</p>
                        </div>
                        <div class="element-card">
                            <img src="https://i0.wp.com/periodic-table.com/wp-content/uploads/2018/11/Francium.jpg?fit=238%2C212&ssl=1" alt="Francium" class="element-image">
                            <h4 class="font-bold text-lg">Francium (Fr)</h4>
                            <p class="text-sm text-gray-600">Atomic: 87</p>
                        </div>
                    </div>
                </div>
                
                <!-- Element Details -->
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-info mr-2 text-indigo-600"></i>
                        Element Details
                    </h3>
                    <div class="overflow-x-auto">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Element</th>
                                    <th>Symbol</th>
                                    <th>Atomic Number</th>
                                    <th>Electron Configuration</th>
                                    <th>Density (g/cm³)</th>
                                    <th>Melting Point (°C)</th>
                                    <th>Key Uses</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="font-medium">Lithium</td>
                                    <td>Li</td>
                                    <td>3</td>
                                    <td>2, 1</td>
                                    <td>0.534</td>
                                    <td>180.5</td>
                                    <td>Batteries, ceramics, mood stabilizers</td>
                                </tr>
                                <tr>
                                    <td class="font-medium">Sodium</td>
                                    <td>Na</td>
                                    <td>11</td>
                                    <td>2, 8, 1</td>
                                    <td>0.968</td>
                                    <td>97.8</td>
                                    <td>Street lights, salt, soap</td>
                                </tr>
                                <tr>
                                    <td class="font-medium">Potassium</td>
                                    <td>K</td>
                                    <td>19</td>
                                    <td>2, 8, 8, 1</td>
                                    <td>0.89</td>
                                    <td>63.5</td>
                                    <td>Fertilizers, soap, glass</td>
                                </tr>
                                <tr>
                                    <td class="font-medium">Rubidium</td>
                                    <td>Rb</td>
                                    <td>37</td>
                                    <td>2, 8, 18, 8,1</td>
                                    <td>1.532</td>
                                    <td>39.3</td>
                                    <td>Atomic clocks, photocells</td>
                                </tr>
                                <tr>
                                    <td class="font-medium">Cesium</td>
                                    <td>Cs</td>
                                    <td>55</td>
                                    <td>2, 8, 18, 18, 8, 1</td>
                                    <td>1.93</td>
                                    <td>28.4</td>
                                    <td>Atomic clocks, drilling fluids</td>
                                </tr>
                                <tr>
                                    <td class="font-medium">Francium</td>
                                    <td>Fr</td>
                                    <td>87</td>
                                    <td>2, 8, 18, 32, 18, 8, 1</td>
                                    <td>~1.87</td>
                                    <td>~27</td>
                                    <td>Research purposes only</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="highlight-box mt-4">
                        <h4>Occurrence and Extraction</h4>
                        <p>Group 1 metals are never found free in nature due to their high reactivity. They are typically found as:
                        <ul class="list-disc pl-5 mt-2">
                            <li>Chlorides (e.g., rock salt - NaCl)</li>
                            <li>Carbonates (e.g., limestone - CaCO₃, which contains Na and K impurities)</li>
                            <li>Sulfates (e.g., Chile saltpeter - NaNO₃)</li>
                        </ul>
                        <p class="mt-2">They are extracted by electrolysis of their molten chlorides, as chemical reduction is not possible.</p>
                    </div>
                </div>
            </div>
            
            <!-- Properties Section -->
            <div id="properties-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-flask mr-2 text-indigo-600"></i>
                        Properties & Characteristics
                    </h3>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="showTab('physical')">Physical</button>
                        <button class="tab" onclick="showTab('chemical')">Chemical</button>
                        <button class="tab" onclick="showTab('trends')">Trends</button>
                    </div>
                    
                    <div id="physical" class="tab-content active">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Physical Properties</h4>
                                <ul class="space-y-2 text-gray-600">
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Soft metals that can be cut with a knife</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Low density - lithium floats on water</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Low melting and boiling points</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Good conductors of heat and electricity</span>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Appearance</h4>
                                <ul class="space-y-2 text-gray-600">
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Silvery-white, shiny metals</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Tarnish quickly in air</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                        <span>Freshly cut surfaces are highly reflective</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="highlight-box mt-4">
                            <h4>Why are Group 1 metals soft?</h4>
                            <p>Group 1 metals have a metallic structure held together by metallic bonds. The bonds are relatively weak because:
                            <ul class="list-disc pl-5 mt-2">
                                <li>Each atom contributes only one electron to the "sea" of delocalized electrons</li>
                                <li>The atomic radius is relatively large</li>
                                <li>The charge on the cation is only +1</li>
                            </ul>
                            <p class="mt-2">These factors result in weak metallic bonding, making the metals soft with low melting points.</p>
                        </div>
                    </div>
                    
                    <div id="chemical" class="tab-content">
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Chemical Properties</h4>
                                <p class="text-gray-600 mb-4">
                                    Group 1 elements are highly reactive metals with one valence electron that they readily lose to form +1 ions.
                                </p>
                                <div class="equation-box">
                                    <p class="text-gray-700 mb-2">General ionization reaction:</p>
                                    <p class="equation">M → M⁺ + e⁻</p>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Reactivity</h4>
                                <p class="text-gray-600">
                                    Reactivity increases down the group as the atomic radius increases and the valence electron is further from the nucleus, making it easier to lose. This is shown by the decreasing first ionization energy down the group.
                                </p>
                                
                                <div class="highlight-box mt-3">
                                    <h4>Ionization Energy Trend</h4>
                                    <p>First ionization energy decreases down Group 1 because:
                                    <ul class="list-disc pl-5 mt-2">
                                        <li>Atomic radius increases</li>
                                        <li>Outer electron is further from the nucleus</li>
                                        <li>More inner electron shells shield the outer electron from the nucleus</li>
                                    </ul>
                                    <p class="mt-2">This makes it easier to remove the outer electron, increasing reactivity.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="trends" class="tab-content">
                        <div class="space-y-4">
                            <h4 class="font-semibold text-gray-700 mb-3">Trends Down Group 1</h4>
                            
                            <div class="overflow-x-auto">
                                <table class="comparison-table">
                                    <thead>
                                        <tr>
                                            <th>Property</th>
                                            <th>Trend</th>
                                            <th>Reason</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Atomic radius</td>
                                            <td>Increases</td>
                                            <td>More electron shells</td>
                                        </tr>
                                        <tr>
                                            <td>First ionization energy</td>
                                            <td>Decreases</td>
                                            <td>Outer electron further from nucleus</td>
                                        </tr>
                                        <tr>
                                            <td>Reactivity</td>
                                            <td>Increases</td>
                                            <td>Easier to lose valence electron</td>
                                        </tr>
                                        <tr>
                                            <td>Melting/boiling point</td>
                                            <td>Decreases</td>
                                            <td>Weaker metallic bonding</td>
                                        </tr>
                                        <tr>
                                            <td>Density</td>
                                            <td>Increases</td>
                                            <td>Exception: K < Na</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="key-point">
                                <h4>Important Exception</h4>
                                <p>While density generally increases down Group 1, potassium (K) is less dense than sodium (Na). This is because the increase in atomic mass is offset by a larger increase in atomic volume.</p>
                            </div>
                            
                            <div class="highlight-box mt-3">
                                <h4>Practical Observation of Trends</h4>
                                <p>The reactivity trend can be clearly observed in the reaction with water:
                                <ul class="list-disc pl-5 mt-2">
                                    <li><strong>Lithium:</strong> Fizzes steadily, moves slowly on surface</li>
                                    <li><strong>Sodium:</strong> Fizzes rapidly, melts into a ball, moves quickly</li>
                                    <li><strong>Potassium:</strong> Fizzes very rapidly, may ignite with lilac flame, moves very quickly</li>
                                </ul>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Reactions Section -->
            <div id="reactions-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-vial mr-2 text-indigo-600"></i>
                        Chemical Reactions
                    </h3>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="showTab('water')">With Water</button>
                        <button class="tab" onclick="showTab('oxygen')">With Oxygen</button>
                        <button class="tab" onclick="showTab('halogens')">With Halogens</button>
                        <button class="tab" onclick="showTab('acids')">With Acids</button>
                    </div>
                    
                    <div id="water" class="tab-content active">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Reaction with Water</h4>
                                <div class="equation-box">
                                    <p class="text-gray-700 mb-2">General equation:</p>
                                    <p class="equation">2M(s) + 2H₂O(l) → 2MOH(aq) + H₂(g)</p>
                                </div>
                                <p class="text-gray-600 mb-4">
                                    All Group 1 metals react with water to produce hydrogen gas and the corresponding metal hydroxide. 
                                    The reactivity increases down the group, with lithium reacting relatively slowly and cesium reacting explosively.
                                </p>
                                
                                <div class="highlight-box">
                                    <h4>Observations for Different Metals</h4>
                                    <div class="grid md:grid-cols-3 gap-4 mt-3">
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <h5 class="font-semibold text-blue-800">Lithium</h5>
                                            <p class="text-sm text-blue-600">Fizzes steadily</p>
                                            <p class="text-xs text-blue-500 mt-1">Doesn't melt</p>
                                            <p class="text-xs text-blue-500 mt-1">Moves slowly on surface</p>
                                        </div>
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <h5 class="font-semibold text-blue-800">Sodium</h5>
                                            <p class="text-sm text-blue-600">Fizzes rapidly</p>
                                            <p class="text-xs text-blue-500 mt-1">Melts into a ball</p>
                                            <p class="text-xs text-blue-500 mt-1">Moves quickly on surface</p>
                                        </div>
                                        <div class="bg-blue-50 p-3 rounded-lg">
                                            <h5 class="font-semibold text-blue-800">Potassium</h5>
                                            <p class="text-sm text-blue-600">Fizzes very rapidly</p>
                                            <p class="text-xs text-blue-500 mt-1">Ignites with lilac flame</p>
                                            <p class="text-xs text-blue-500 mt-1">May explode</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Reaction Mechanism</h4>
                                <p class="text-gray-600">
                                    The reaction with water is a redox reaction where the metal is oxidized and water is reduced:
                                </p>
                                <div class="equation-box">
                                    <p class="text-gray-700 mb-2">Oxidation: 2M → 2M⁺ + 2e⁻</p>
                                    <p class="text-gray-700 mb-2">Reduction: 2H₂O + 2e⁻ → 2OH⁻ + H₂</p>
                                    <p class="text-gray-700">Overall: 2M + 2H₂O → 2MOH + H₂</p>
                                </div>
                            </div>
                            
                            <div class="bg-indigo-50 p-4 rounded-lg">
                                <h5 class="font-semibold text-indigo-800 mb-2">Safety Note:</h5>
                                <p class="text-indigo-700">
                                    Due to their violent reactions with water, Group 1 metals must be stored under oil to prevent contact with moisture in the air. 
                                    Small pieces should always be used for demonstrations, and safety goggles must be worn.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="oxygen" class="tab-content">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Reaction with Oxygen</h4>
                                <p class="text-gray-600 mb-4">
                                    Group 1 metals react with oxygen to form oxides, peroxides, or superoxides depending on the metal and reaction conditions.
                                </p>
                                
                                <div class="grid md:grid-cols-3 gap-4">
                                    <div class="bg-green-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-green-800">Lithium</h5>
                                        <p class="text-sm text-green-600">Forms Li₂O (oxide)</p>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">4Li + O₂ → 2Li₂O</p>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-green-800">Sodium</h5>
                                        <p class="text-sm text-green-600">Forms Na₂O₂ (peroxide)</p>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">2Na + O₂ → Na₂O₂</p>
                                        </div>
                                    </div>
                                    <div class="bg-green-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-green-800">Potassium</h5>
                                        <p class="text-sm text-green-600">Forms KO₂ (superoxide)</p>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">K + O₂ → KO₂</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Trend in Oxide Formation:</h5>
                                <p class="text-gray-600">
                                    As we move down the group, the tendency to form peroxides and superoxides increases due to the larger size of the metal ions, which can stabilize larger anions.
                                </p>
                                
                                <div class="highlight-box mt-3">
                                    <h4>Why the Change in Products?</h4>
                                    <p>The stability of different oxides depends on the size of the cation:
                                    <ul class="list-disc pl-5 mt-2">
                                        <li>Small Li⁺ stabilizes the small O²⁻ ion in Li₂O</li>
                                        <li>Medium Na⁺ stabilizes the O₂²⁻ ion in Na₂O₂</li>
                                        <li>Large K⁺, Rb⁺, Cs⁺ stabilize the large O₂⁻ ion in superoxides</li>
                                    </ul>
                                    <p class="mt-2">This is an example of how cation size affects compound stability.</p>
                                </div>
                            </div>
                            
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Reactions of the Oxides with Water</h5>
                                <p class="text-gray-600">All Group 1 oxides, peroxides, and superoxides react with water to form alkaline solutions:</p>
                                <div class="grid md:grid-cols-3 gap-4 mt-3">
                                    <div class="bg-purple-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-purple-800">Oxide</h5>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">Li₂O + H₂O → 2LiOH</p>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-purple-800">Peroxide</h5>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">Na₂O₂ + 2H₂O → 2NaOH + H₂O₂</p>
                                        </div>
                                    </div>
                                    <div class="bg-purple-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-purple-800">Superoxide</h5>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">2KO₂ + 2H₂O → 2KOH + H₂O₂ + O₂</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="halogens" class="tab-content">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Reaction with Halogens</h4>
                                <div class="equation-box">
                                    <p class="text-gray-700 mb-2">General equation:</p>
                                    <p class="equation">2M(s) + X₂ → 2MX(s)</p>
                                    <p class="text-gray-600 text-sm">Where X = F, Cl, Br, I</p>
                                </div>
                                <p class="text-gray-600 mb-4">
                                    Group 1 metals react vigorously with halogens to form ionic halides. These reactions are highly exothermic and often produce bright flames.
                                </p>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div class="bg-purple-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-purple-800">With Chlorine</h5>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">2Na + Cl₂ → 2NaCl</p>
                                        </div>
                                        <p class="text-sm text-purple-600 mt-2">Bright yellow flame</p>
                                    </div>
                                    <div class="bg-purple-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-purple-800">With Bromine</h5>
                                        <div class="equation-box mt-2">
                                            <p class="equation text-sm">2K + Br₂ → 2KBr</p>
                                        </div>
                                        <p class="text-sm text-purple-600 mt-2">Red-brown vapor</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h5 class="font-semibold text-purple-800 mb-2">Properties of Halides:</h5>
                                <ul class="text-sm text-purple-700 space-y-1">
                                    <li>• All are white crystalline solids at room temperature</li>
                                    <li>• High melting and boiling points due to strong ionic bonding</li>
                                    <li>• Soluble in water, forming neutral solutions</li>
                                    <li>• Conduct electricity when molten or in aqueous solution</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Test for Halide Ions</h5>
                                <p class="text-gray-600">
                                    The halide ions (Cl⁻, Br⁻, I⁻) can be identified using silver nitrate solution:
                                </p>
                                <div class="grid md:grid-cols-3 gap-4 mt-3">
                                    <div class="bg-yellow-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-yellow-800">Chloride</h5>
                                        <p class="text-sm text-yellow-600">Forms white precipitate of AgCl</p>
                                        <p class="text-xs text-yellow-500 mt-1">Soluble in dilute NH₃</p>
                                    </div>
                                    <div class="bg-yellow-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-yellow-800">Bromide</h5>
                                        <p class="text-sm text-yellow-600">Forms cream precipitate of AgBr</p>
                                        <p class="text-xs text-yellow-500 mt-1">Partially soluble in conc. NH₃</p>
                                    </div>
                                    <div class="bg-yellow-50 p-3 rounded-lg">
                                        <h5 class="font-semibold text-yellow-800">Iodide</h5>
                                        <p class="text-sm text-yellow-600">Forms yellow precipitate of AgI</p>
                                        <p class="text-xs text-yellow-500 mt-1">Insoluble in NH₃</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="acids" class="tab-content">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Reaction with Acids</h4>
                                <div class="equation-box">
                                    <p class="text-gray-700 mb-2">General equation:</p>
                                    <p class="equation">2M(s) + 2H⁺(aq) → 2M⁺(aq) + H₂(g)</p>
                                </div>
                                <p class="text-gray-600 mb-4">
                                    Group 1 metals react with acids to produce hydrogen gas and the corresponding salt. These reactions are extremely vigorous and dangerous due to the high reactivity of the metals.
                                </p>
                                
                                <div class="bg-red-50 p-4 rounded-lg mb-4">
                                    <h5 class="font-semibold text-red-800 mb-2">⚠️ Safety Warning:</h5>
                                    <p class="text-red-700">
                                        These reactions are too violent to be performed safely in a school laboratory. The hydrogen gas produced is highly flammable and can explode. 
                                        Never attempt to react Group 1 metals with acids outside of specialized facilities with proper safety equipment.
                                    </p>
                                </div>
                            </div>
                            
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Example Reactions:</h5>
                                <div class="space-y-2">
                                    <div class="bg-gray-50 p-3 rounded-lg">
                                        <p class="text-sm font-mono">2Li(s) + 2HCl(aq) → 2LiCl(aq) + H₂(g)</p>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded-lg">
                                        <p class="text-sm font-mono">2Na(s) + H₂SO₄(aq) → Na₂SO₄(aq) + H₂(g)</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h5 class="font-semibold text-gray-700 mb-2">Reaction Mechanism</h5>
                                <p class="text-gray-600">
                                    The reaction with acids is a redox reaction where the metal is oxidized and hydrogen ions from the acid are reduced:
                                </p>
                                <div class="equation-box mt-3">
                                    <p class="text-gray-700 mb-2">Oxidation: 2M → 2M⁺ + 2e⁻</p>
                                    <p class="text-gray-700 mb-2">Reduction: 2H⁺ + 2e⁻ → H₂</p>
                                    <p class="text-gray-700">Overall: 2M + 2H⁺ → 2M⁺ + H₂</p>
                                </div>
                            </div>
                            
                            <div class="highlight-box">
                                <h4>Why So Vigorous?</h4>
                                <p>The reaction with acids is more vigorous than with water because:
                                <ul class="list-disc pl-5 mt-2">
                                    <li>Acids provide a higher concentration of H⁺ ions than water</li>
                                    <li>The reduction potential of H⁺ is higher than that of H₂O</li>
                                    <li>This makes the reaction more thermodynamically favorable</li>
                                </ul>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Study Groups Section -->
            <div id="study-groups-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-users mr-2 text-indigo-600"></i>
                            Study Circles
                        </h3>
                        <button onclick="showCreateStudyGroup()" class="btn btn-primary">
                            <i class="fas fa-plus"></i>
                            Create Group
                        </button>
                    </div>
                    <div id="studyGroupsContainer">
                        <!-- Study groups will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Discussion Section -->
            <div id="discussion-section" class="content-section" style="display: none;">
                <div class="comment-section fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-comments mr-2 text-indigo-600"></i>
                        Discussion
                    </h3>
                    <div id="commentsContainer">
                        <!-- Comments will be loaded here -->
                    </div>
                    <div class="comment-form">
                        <input type="text" id="commentInput" class="comment-input" placeholder="Share your thoughts...">
                        <button onclick="addComment()" class="comment-submit">Post</button>
                    </div>
                </div>
            </div>
            
            <!-- Post Quiz Section -->
            <div id="quiz-section" class="content-section" style="display: none;">
                <div class="content-card fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-graduation-cap mr-2 text-indigo-600"></i>
                        Final Assessment
                    </h3>
                    <p class="text-gray-600 mb-4">
                        Test your knowledge after completing the learning materials. See how much you've improved!
                    </p>
                    <button onclick="startPostQuiz()" class="btn btn-primary">
                        <i class="fas fa-play"></i>
                        Start Post-Quiz
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="text-center mb-6">
                <i class="fas fa-atom text-4xl text-indigo-600 mb-3"></i>
                <h2 class="text-2xl font-bold text-gray-800">Welcome to Chemistry Mastery</h2>
                <p class="text-gray-600">Sign in to begin your learning journey</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="your@email.com" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Or continue with</p>
                <button onclick="signInWithGoogle()" class="btn btn-secondary w-full mt-2">
                    <i class="fab fa-google"></i>
                    Google
                </button>
            </div>
        </div>
    </div>
    
    <!-- Quiz Modal -->
    <div id="quizModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800" id="quizTitle">Pre-Quiz</h2>
                <button onclick="closeQuiz()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="quizProgress" class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm text-gray-600">Question <span id="currentQuestion">1</span> of <span id="totalQuestions">7</span></span>
                    <span class="text-sm text-gray-600">Score: <span id="currentScore">0</span></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 14.3%"></div>
                </div>
            </div>
            
            <div id="quizContent">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-4" id="questionText">Loading question...</h3>
                    <div id="optionsContainer"></div>
                </div>
                
                <div id="feedback" class="hidden mb-4 p-3 rounded-lg text-sm"></div>
                
                <div class="flex justify-between items-center">
                    <button id="prevButton" class="btn btn-secondary hidden" onclick="previousQuestion()">
                        <i class="fas fa-arrow-left"></i>
                        Previous
                    </button>
                    <div class="flex gap-2">
                        <button id="submitButton" class="btn btn-primary" onclick="submitAnswer()">
                            Submit Answer
                        </button>
                        <button id="nextButton" class="btn btn-primary hidden" onclick="nextQuestion()">
                            Next
                            <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="quizResults" class="hidden text-center">
                <i class="fas fa-trophy text-5xl text-yellow-500 mb-4"></i>
                <h3 class="text-2xl font-bold mb-3">Quiz Complete!</h3>
                <div class="text-4xl font-bold text-indigo-600 mb-3" id="finalScore">0/7</div>
                <p class="text-gray-600 mb-6" id="scoreMessage">Great job!</p>
                
                <div id="postQuizActions" class="hidden">
                    <button onclick="completePreQuiz()" class="btn btn-primary">
                        <i class="fas fa-arrow-right"></i>
                        Continue to Learning Materials
                    </button>
                </div>
                
                <div id="finalActions" class="hidden">
                    <button onclick="closeQuiz()" class="btn btn-primary">
                        <i class="fas fa-check"></i>
                        Finish
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Create Study Group Modal -->
    <div id="createStudyGroupModal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Create Study Group</h2>
            
            <form id="createStudyGroupForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Group Name</label>
                    <input type="text" id="groupName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter group name" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="groupDescription" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" rows="3" placeholder="Describe your study group" required></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Goal</label>
                    <input type="text" id="groupGoal" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="What's the goal of this group?" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Max Members</label>
                    <select id="groupMaxMembers" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                        <option value="5">5 members</option>
                        <option value="10">10 members</option>
                        <option value="15">15 members</option>
                        <option value="20">20 members</option>
                    </select>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-plus"></i>
                    Create Group
                </button>
            </form>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer"></div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 3000; align-items: center; justify-content: center;">
        <div class="bg-white rounded-lg p-6 text-center">
            <div class="spinner"></div>
            <p class="mt-2 text-gray-600">Loading...</p>
        </div>
    </div>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBOp4x0lTFvmt2s3MQKBRYmZT9IJ2ZaRi8",
            authDomain: "group-1-alkali-metals.firebaseapp.com",
            databaseURL: "https://group-1-alkali-metals-default-rtdb.firebaseio.com",
            projectId: "group-1-alkali-metals",
            storageBucket: "group-1-alkali-metals.firebasestorage.app",
            messagingSenderId: "806417495419",
            appId: "1:806417495419:web:5b80607e8a23e96da4f9de",
            measurementId: "G-S76E52MQ37"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        
        // Global variables
        let currentUser = null;
        let userData = null;
        let currentQuiz = [];
        let currentQuestion = 0;
        let score = 0;
        let selectedOption = null;
        let quizType = '';
        let answerSubmitted = false;
        let justSignedIn = false; // Flag to track if user just signed in
        
        // Quiz questions - Improved for better educational content
        const preQuizQuestions = [
            {
                type: 'single',
                question: "Which of the following is the correct electron configuration of sodium?",
                options: ["[He] 2s² 2p⁶ 3s¹", "[Ne] 3s²", "[Ne] 3s¹", "[Ar] 4s¹"],
                correct: 2,
                explanation: "Sodium (Na) has atomic number 11. Its electron configuration is [Ne] 3s¹, meaning it has the same configuration as neon plus one electron in the 3s orbital."
            },
            {
                type: 'single',
                question: "Group 1 metals are stored under oil because:",
                options: ["They are expensive", "They react with air and moisture", "They evaporate easily", "They are radioactive"],
                correct: 1,
                explanation: "Group 1 metals are highly reactive and react with both oxygen and moisture in the air. Storing them under oil prevents these reactions."
            },
            {
                type: 'single',
                question: "What is the main product when sodium reacts with cold water?",
                options: ["Sodium oxide and hydrogen", "Sodium hydroxide and hydrogen", "Sodium peroxide and hydrogen", "Sodium and water"],
                correct: 1,
                explanation: "Sodium reacts with cold water to produce sodium hydroxide (NaOH) and hydrogen gas (H₂). The equation is: 2Na + 2H₂O → 2NaOH + H₂."
            },
            {
                type: 'single',
                question: "Which Group 1 element produces a lilac flame during its reaction with water?",
                options: ["Lithium", "Sodium", "Potassium", "Rubidium"],
                correct: 2,
                explanation: "Potassium produces a characteristic lilac flame during its reaction with water. This flame test is used to identify potassium ions."
            },
            {
                type: 'single',
                question: "As you go down Group 1, the first ionization energy:",
                options: ["Increases", "Decreases", "Stays the same", "Increases then decreases"],
                correct: 1,
                explanation: "First ionization energy decreases down Group 1 because the atomic radius increases and the outer electron is further from the nucleus, making it easier to remove."
            },
            {
                type: 'single',
                question: "Which of these oxides is formed when lithium burns in oxygen?",
                options: ["Li₂O", "Li₂O₂", "LiO₂", "Li₂O and Li₂O₂"],
                correct: 0,
                explanation: "Lithium primarily forms the normal oxide Li₂O when burned in oxygen, unlike other Group 1 metals which form peroxides or superoxides."
            },
            {
                type: 'single',
                question: "Which statement about Group 1 metals is INCORRECT?",
                options: [
                    "They all have one valence electron",
                    "They form +1 ions",
                    "They become less reactive down the group",
                    "They have low melting points"
                ],
                correct: 2,
                explanation: "Group 1 metals become more reactive down the group, not less reactive. This is because it becomes easier to lose the single valence electron."
            }
        ];
        
        const postQuizQuestions = [
            {
                type: 'single',
                question: "Which Group 1 element has the lowest density and floats on water?",
                options: ["Sodium", "Lithium", "Cesium", "Rubidium"],
                correct: 1,
                explanation: "Lithium has the lowest density (0.534 g/cm³) of all Group 1 metals, which is less than water (1 g/cm³), so it floats on water."
            },
            {
                type: 'single',
                question: "Why does potassium react more vigorously with water than sodium?",
                options: [
                    "Potassium has more protons",
                    "Potassium's outer electron is further from the nucleus",
                    "Potassium is heavier",
                    "Potassium has a higher melting point"
                ],
                correct: 1,
                explanation: "Potassium's outer electron is further from the nucleus and experiences less attraction, making it easier to lose. This increases its reactivity compared to sodium."
            },
            {
                type: 'single',
                question: "Which compound does sodium primarily form when it reacts with oxygen?",
                options: ["Na₂O", "Na₂O₂", "NaO₂", "Both Na₂O and Na₂O₂"],
                correct: 1,
                explanation: "Sodium primarily forms the peroxide Na₂O₂ when burned in air, unlike lithium which forms the normal oxide Li₂O."
            },
            {
                type: 'single',
                question: "What color flame does rubidium produce during its reactions?",
                options: ["Red", "Yellow", "Lilac", "Red-violet"],
                correct: 3,
                explanation: "Rubidium produces a red-violet flame during its reactions. This is characteristic of the element and is used in flame tests to identify rubidium ions."
            },
            {
                type: 'single',
                question: "Which statement about Group 1 metals is INCORRECT?",
                options: [
                    "They all have one valence electron",
                    "They form +1 ions",
                    "They are good conductors of electricity",
                    "They become less reactive down the group"
                ],
                correct: 3,
                explanation: "Group 1 metals become more reactive down the group, not less reactive. This is due to decreasing ionization energy down the group."
            },
            {
                type: 'single',
                question: "What is the main reason cesium is the most reactive Group 1 metal?",
                options: [
                    "It has the most electrons",
                    "It has the largest atomic radius",
                    "It has the highest density",
                    "It has the lowest melting point"
                ],
                correct: 1,
                explanation: "Cesium has the largest atomic radius in Group 1, so its outer electron is furthest from the nucleus and easiest to lose, making it the most reactive."
            },
            {
                type: 'single',
                question: "Which observation best describes francium's properties?",
                options: [
                    "It's the most stable Group 1 metal",
                    "It's extremely rare and radioactive",
                    "It's commonly found in nature",
                    "It has a very high melting point"
                ],
                correct: 1,
                explanation: "Francium is extremely rare, highly radioactive, and has a very short half-life (about 22 minutes), making it difficult to study and observe its properties."
            }
        ];
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication state on page load
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = user;
                    console.log("User is signed in:", user.uid);
                    
                    // Check if this is a fresh sign-in (not just page reload)
                    if (justSignedIn) {
                        console.log("User just signed in, showing pre-quiz introduction");
                        // User just signed in, show pre-quiz introduction
                        showPreQuizIntroduction();
                        justSignedIn = false; // Reset the flag
                    } else {
                        // This is a page reload or existing session
                        console.log("Existing session, checking pre-quiz status");
                        checkPreQuizStatus();
                    }
                } else {
                    console.log("No user signed in");
                    // Show landing page
                    document.getElementById('landingPage').style.display = 'flex';
                    document.getElementById('prequizPage').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'none';
                }
            });
            
            // Set up login form
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (!isValidEmail(email)) {
                    showToast('error', 'Invalid Email', 'Please enter a valid email address');
                    return;
                }
                
                showLoading();
                
                auth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        const user = userCredential.user;
                        console.log("Sign in successful:", user.uid);
                        showToast('success', 'Welcome back!', 'You have been successfully signed in.');
                        closeLoginModal();
                        // Set flag to indicate user just signed in
                        justSignedIn = true;
                        // The onAuthStateChanged listener will handle showing the pre-quiz introduction
                    })
                    .catch((error) => {
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        console.error("Sign in error:", errorCode, errorMessage);
                        
                        if (errorCode === 'auth/unauthorized-domain') {
                            showToast('error', 'Domain not authorized', 
                                'Please add your GitHub Pages domain to the authorized domains in your Firebase project settings.');
                        } else {
                            showToast('error', 'Sign in failed', errorMessage);
                        }
                    })
                    .finally(() => {
                        hideLoading();
                    });
            });
            
            // Set up create study group form
            document.getElementById('createStudyGroupForm').addEventListener('submit', (e) => {
                e.preventDefault();
                createStudyGroup();
            });
            
            // Add click handlers for landing page buttons
            document.addEventListener('click', function(e) {
                if (e.target.matches('#landingPage .btn-primary') || e.target.closest('#landingPage .btn-primary')) {
                    showLoginModal();
                }
                if (e.target.matches('#landingPage .btn-secondary') || e.target.closest('#landingPage .btn-secondary')) {
                    signInWithGoogle();
                }
            });
        });
        
        // Toggle sidebar (mobile)
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }
        
        // Navigate to section
        function navigateToSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(`${sectionName}-section`).style.display = 'block';
            
            // Update active nav item
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }
        
        // Show pre-quiz introduction page
        function showPreQuizIntroduction() {
            console.log("Showing pre-quiz introduction");
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('prequizPage').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }
        
        // Check if user has completed pre-quiz
        function checkPreQuizStatus() {
            console.log("Checking pre-quiz status for user:", currentUser.uid);
            
            if (!currentUser) {
                console.log("No current user, showing landing page");
                document.getElementById('landingPage').style.display = 'flex';
                document.getElementById('prequizPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'none';
                return;
            }
            
            const userRef = database.ref('users/' + currentUser.uid);
            
            userRef.once('value').then((snapshot) => {
                console.log("User data snapshot:", snapshot.val());
                
                if (snapshot.exists()) {
                    userData = snapshot.val();
                    console.log("User data loaded:", userData);
                    
                    if (userData.preQuizCompleted) {
                        console.log("Pre-quiz completed, showing main app");
                        showMainApp();
                    } else {
                        console.log("Pre-quiz not completed, showing pre-quiz introduction");
                        showPreQuizIntroduction();
                    }
                } else {
                    console.log("User data doesn't exist, creating new user");
                    // Create new user
                    const newUser = {
                        uid: currentUser.uid,
                        email: currentUser.email,
                        displayName: currentUser.displayName || 'User',
                        points: 0,
                        currentStreak: 1,
                        lastActiveDate: new Date().toDateString(),
                        preQuizCompleted: false,
                        postQuizCompleted: false,
                        createdAt: firebase.database.ServerValue.TIMESTAMP
                    };
                    
                    userRef.set(newUser).then(() => {
                        userData = newUser;
                        console.log("New user created, showing pre-quiz introduction");
                        showPreQuizIntroduction();
                    }).catch((error) => {
                        console.error("Error creating new user:", error);
                        showToast('error', 'Error', 'Failed to create user profile.');
                    });
                }
            }).catch((error) => {
                console.error("Error checking pre-quiz status:", error);
                showToast('error', 'Error', 'Failed to check your progress.');
                document.getElementById('landingPage').style.display = 'flex';
                document.getElementById('prequizPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'none';
            });
        }
        
        // Show main application
        function showMainApp() {
            console.log("Showing main app");
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('prequizPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Update user profile
            document.getElementById('userName').textContent = userData.displayName || 'User';
            document.getElementById('userPoints').textContent = userData.points || 0;
            document.getElementById('userStreak').textContent = userData.currentStreak || 0;
            
            // Load data
            loadStudyGroups();
            loadComments();
            
            // Add fade-in animation to elements
            document.querySelectorAll('.fade-in').forEach((el, index) => {
                el.style.animationDelay = `${index * 0.1}s`;
            });
        }
        
        // Load user data
        function loadUserData(userId) {
            const userRef = database.ref('users/' + userId);
            
            userRef.once('value').then((snapshot) => {
                if (!snapshot.exists()) {
                    // Create new user
                    const newUser = {
                        uid: userId,
                        email: currentUser.email,
                        displayName: currentUser.displayName || 'User',
                        points: 0,
                        currentStreak: 1,
                        lastActiveDate: new Date().toDateString(),
                        preQuizCompleted: false,
                        postQuizCompleted: false,
                        createdAt: firebase.database.ServerValue.TIMESTAMP
                    };
                    
                    userRef.set(newUser).then(() => {
                        userData = newUser;
                    });
                }
            });
        }
        
        // Start pre-quiz
        function startPreQuiz() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to take the quiz.');
                showLoginModal();
                return;
            }
            
            console.log("Starting pre-quiz");
            
            // Hide pre-quiz introduction page
            document.getElementById('prequizPage').style.display = 'none';
            
            currentQuiz = [...preQuizQuestions];
            quizType = 'pre';
            currentQuestion = 0;
            score = 0;
            selectedOption = null;
            answerSubmitted = false;
            showQuiz();
        }
        
        // Start post-quiz
        function startPostQuiz() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to take the quiz.');
                showLoginModal();
                return;
            }
            
            currentQuiz = [...postQuizQuestions];
            quizType = 'post';
            currentQuestion = 0;
            score = 0;
            selectedOption = null;
            answerSubmitted = false;
            showQuiz();
        }
        
        // Show quiz modal
        function showQuiz() {
            console.log("Showing quiz modal");
            document.getElementById('quizModal').classList.add('active');
            document.getElementById('quizProgress').style.display = 'block';
            document.getElementById('quizContent').style.display = 'block';
            document.getElementById('quizResults').style.display = 'none';
            
            document.getElementById('quizTitle').textContent = quizType === 'pre' ? 'Pre-Quiz' : 'Post-Quiz';
            document.getElementById('currentQuestion').textContent = currentQuestion + 1;
            document.getElementById('totalQuestions').textContent = currentQuiz.length;
            document.getElementById('currentScore').textContent = score;
            document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
            
            loadQuestion();
        }
        
        // Load question
        function loadQuestion() {
            const question = currentQuiz[currentQuestion];
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            // Reset buttons and feedback
            document.getElementById('submitButton').style.display = 'inline-flex';
            document.getElementById('submitButton').disabled = false;
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('feedback').classList.add('hidden');
            answerSubmitted = false;
            
            // Load options
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('submitButton').disabled = true;
            document.getElementById('prevButton').classList.toggle('hidden', currentQuestion === 0);
            
            selectedOption = null;
        }
        
        // Select option
        function selectOption(index) {
            if (answerSubmitted) return;
            
            selectedOption = index;
            const options = document.querySelectorAll('.quiz-option');
            
            // Remove previous selection
            options.forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selection to clicked option
            options[index].classList.add('selected');
            
            // Enable submit button
            document.getElementById('submitButton').disabled = false;
        }
        
        // Submit answer
        function submitAnswer() {
            if (answerSubmitted) return;
            
            const question = currentQuiz[currentQuestion];
            const isCorrect = selectedOption === question.correct;
            
            const feedback = document.getElementById('feedback');
            if (isCorrect) {
                feedback.className = 'mb-4 p-3 rounded-lg bg-green-100 text-green-800 text-sm';
                feedback.textContent = 'Correct! ' + question.explanation;
                score++;
                
                // Award points
                awardPoints(10, 'Correct answer');
            } else {
                feedback.className = 'mb-4 p-3 rounded-lg bg-red-100 text-red-800 text-sm';
                feedback.textContent = 'Incorrect. ' + question.explanation;
            }
            
            feedback.classList.remove('hidden');
            document.getElementById('submitButton').style.display = 'none';
            document.getElementById('nextButton').classList.remove('hidden');
            document.getElementById('currentScore').textContent = score;
            
            // Mark answer as submitted
            answerSubmitted = true;
            
            // Show correct answers for visual feedback
            const options = document.querySelectorAll('.quiz-option');
            options[question.correct].classList.add('correct');
            if (selectedOption !== null && selectedOption !== question.correct) {
                options[selectedOption].classList.add('incorrect');
            }
        }
        
        // Next question
        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion >= currentQuiz.length) {
                showResults();
                return;
            }
            
            document.getElementById('currentQuestion').textContent = currentQuestion + 1;
            document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
            loadQuestion();
        }
        
        // Previous question
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                document.getElementById('currentQuestion').textContent = currentQuestion + 1;
                document.getElementById('progressFill').style.width = ((currentQuestion + 1) / currentQuiz.length * 100) + '%';
                loadQuestion();
            }
        }
        
        // Show quiz results
        function showResults() {
            document.getElementById('quizProgress').style.display = 'none';
            document.getElementById('quizContent').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            
            const percentage = Math.round((score / currentQuiz.length) * 100);
            document.getElementById('finalScore').textContent = `${score}/${currentQuiz.length}`;
            
            let message = '';
            if (percentage >= 80) {
                message = 'Excellent! You have a strong understanding of Group 1 elements.';
            } else if (percentage >= 60) {
                message = 'Good job! You have a solid foundation to build upon.';
            } else if (percentage >= 40) {
                message = 'Not bad! Pay attention to the learning materials to improve.';
            } else {
                message = 'Keep practicing! Review the materials carefully.';
            }
            
            document.getElementById('scoreMessage').textContent = message;
            
            // Save quiz result
            saveQuizResult(score, currentQuiz.length, quizType);
            
            // Show appropriate actions
            if (quizType === 'pre') {
                document.getElementById('postQuizActions').style.display = 'block';
                document.getElementById('finalActions').style.display = 'none';
            } else {
                document.getElementById('postQuizActions').style.display = 'none';
                document.getElementById('finalActions').style.display = 'block';
            }
        }
        
        // Complete pre-quiz and unlock main content
        function completePreQuiz() {
            if (!currentUser) return;
            
            console.log("Completing pre-quiz for user:", currentUser.uid);
            
            const userRef = database.ref('users/' + currentUser.uid);
            
            userRef.update({
                preQuizCompleted: true,
                preQuizScore: score,
                preQuizDate: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                userData.preQuizCompleted = true;
                userData.preQuizScore = score;
                
                console.log("Pre-quiz completed, showing main app");
                
                // Award points for completing pre-quiz
                awardPoints(50, 'Completed pre-quiz');
                
                // Close quiz modal
                closeQuiz();
                
                // Show main app
                showMainApp();
                
                showToast('success', 'Pre-Quiz Complete!', 'You can now access the learning materials.');
            }).catch((error) => {
                console.error("Error updating pre-quiz status:", error);
                showToast('error', 'Error', 'Failed to save pre-quiz results.');
            });
        }
        
        // Save quiz result
        function saveQuizResult(score, totalQuestions, quizType) {
            const resultsRef = database.ref('quizResults').push();
            
            resultsRef.set({
                userId: currentUser.uid,
                userName: userData.displayName,
                score: score,
                totalQuestions: totalQuestions,
                percentage: Math.round((score / totalQuestions) * 100),
                quizType: quizType,
                topic: 'Group 1 - Alkali Metals',
                createdAt: firebase.database.ServerValue.TIMESTAMP
            }).catch((error) => {
                console.error("Error saving quiz result:", error);
            });
        }
        
        // Close quiz
        function closeQuiz() {
            console.log("Closing quiz modal");
            document.getElementById('quizModal').classList.remove('active');
            
            // If user hasn't completed pre-quiz, show pre-quiz introduction
            if (currentUser && userData && !userData.preQuizCompleted) {
                showPreQuizIntroduction();
            }
        }
        
        // Award points to user
        function awardPoints(points, reason) {
            if (!currentUser || !userData) return;
            
            const userRef = database.ref('users/' + currentUser.uid);
            
            const updates = {};
            updates['/points'] = (userData.points || 0) + points;
            updates['/lastActiveDate'] = new Date().toDateString();
            
            // Update streak
            const today = new Date().toDateString();
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayString = yesterday.toDateString();
            
            if (userData.lastActiveDate === yesterdayString) {
                updates['/currentStreak'] = (userData.currentStreak || 1) + 1;
            } else if (userData.lastActiveDate !== today) {
                updates['/currentStreak'] = 1;
            }
            
            userRef.update(updates).then(() => {
                userData.points = updates['/points'];
                userData.currentStreak = updates['/currentStreak'];
                userData.lastActiveDate = updates['/lastActiveDate'];
                
                // Update UI
                document.getElementById('userPoints').textContent = userData.points;
                document.getElementById('userStreak').textContent = userData.currentStreak;
                
                showToast('success', 'Points Awarded', `+${points} points for ${reason}`);
            }).catch((error) => {
                console.error("Error awarding points:", error);
            });
        }
        
        // Load study groups
        function loadStudyGroups() {
            const container = document.getElementById('studyGroupsContainer');
            container.innerHTML = '<div class="spinner"></div>';
            
            const groupsRef = database.ref('studyGroups');
            
            groupsRef.orderByChild('createdAt').on('value', (snapshot) => {
                container.innerHTML = '';
                
                if (!snapshot.exists()) {
                    container.innerHTML = '<p class="text-gray-500 text-center">No study groups yet. Create one!</p>';
                    return;
                }
                
                const groupsArray = [];
                snapshot.forEach((childSnapshot) => {
                    groupsArray.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                
                // Sort by creation date (newest first)
                groupsArray.sort((a, b) => {
                    return new Date(b.createdAt) - new Date(a.createdAt);
                });
                
                groupsArray.forEach(group => {
                    const groupCard = createStudyGroupCard(group);
                    container.appendChild(groupCard);
                });
            }, (error) => {
                console.error("Error loading study groups:", error);
                container.innerHTML = '<p class="text-gray-500 text-center">Error loading study groups.</p>';
            });
        }
        
        // Create study group card
        function createStudyGroupCard(group) {
            const card = document.createElement('div');
            card.className = 'study-group-card';
            
            const isMember = currentUser && group.members && group.members.includes(currentUser.uid);
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-bold text-lg text-gray-800">${group.name}</h4>
                        <p class="text-sm text-gray-600">Created by ${group.creatorName}</p>
                    </div>
                    <button onclick="${isMember ? 'leaveStudyGroup' : 'joinStudyGroup'}('${group.id}')" 
                            class="btn ${isMember ? 'btn-danger' : 'btn-primary'} text-sm">
                        ${isMember ? 'Leave' : 'Join'}
                    </button>
                </div>
                
                <p class="text-gray-700 mb-3">${group.description}</p>
                
                <div class="flex justify-between items-center mb-3">
                    <div>
                        <span class="text-sm font-medium text-gray-700">Goal:</span>
                        <span class="text-sm text-gray-600">${group.goal}</span>
                    </div>
                    <div class="text-sm text-gray-600">
                        ${group.memberCount || 0}/${group.maxMembers} members
                    </div>
                </div>
                
                <div class="flex items-center">
                    <div class="flex -space-x-2">
                        ${(group.members || []).slice(0, 5).map(member => 
                            `<div class="member-avatar">${member.charAt(0).toUpperCase()}</div>`
                        ).join('')}
                        ${(group.memberCount || 0) > 5 ? 
                            `<div class="member-avatar">+${(group.memberCount || 0) - 5}</div>` : ''
                        }
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // Create study group
        function createStudyGroup() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to create study groups.');
                return;
            }
            
            const name = document.getElementById('groupName').value;
            const description = document.getElementById('groupDescription').value;
            const goal = document.getElementById('groupGoal').value;
            const maxMembers = parseInt(document.getElementById('groupMaxMembers').value);
            
            showLoading();
            
            const groupsRef = database.ref('studyGroups').push();
            
            groupsRef.set({
                name: name,
                description: description,
                goal: goal,
                maxMembers: maxMembers,
                creatorId: currentUser.uid,
                creatorName: userData.displayName,
                members: [currentUser.uid],
                memberCount: 1,
                createdAt: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                showToast('success', 'Group Created', 'Your study group has been created successfully.');
                closeCreateStudyGroup();
                document.getElementById('createStudyGroupForm').reset();
                
                // Award points
                awardPoints(20, 'Created study group');
            }).catch((error) => {
                console.error("Error creating study group:", error);
                showToast('error', 'Error', 'Failed to create study group.');
            }).finally(() => {
                hideLoading();
            });
        }
        
        // Join study group
        function joinStudyGroup(groupId) {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to join study groups.');
                return;
            }
            
            const groupRef = database.ref('studyGroups/' + groupId);
            
            groupRef.once('value').then((snapshot) => {
                const group = snapshot.val();
                
                if (!group) {
                    showToast('error', 'Error', 'Study group not found.');
                    return;
                }
                
                // Make sure members is an array
                const members = Array.isArray(group.members) ? [...group.members] : [];
                
                if (members.includes(currentUser.uid)) {
                    showToast('info', 'Already Member', 'You are already a member of this group.');
                    return;
                }
                
                if ((group.memberCount || 0) >= (group.maxMembers || 10)) {
                    showToast('error', 'Group Full', 'This study group is already full.');
                    return;
                }
                
                // Add current user to members array
                members.push(currentUser.uid);
                
                const updates = {};
                updates['/members'] = members;
                updates['/memberCount'] = (group.memberCount || 0) + 1;
                
                groupRef.update(updates).then(() => {
                    showToast('success', 'Joined Group', 'You have successfully joined the study group.');
                    
                    // Award points
                    awardPoints(10, 'Joined study group');
                }).catch((error) => {
                    console.error("Error joining study group:", error);
                    showToast('error', 'Error', 'Failed to join study group.');
                });
            }).catch((error) => {
                console.error("Error getting study group:", error);
                showToast('error', 'Error', 'Failed to join study group.');
            });
        }
        
        // Leave study group
        function leaveStudyGroup(groupId) {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to leave study groups.');
                return;
            }
            
            const groupRef = database.ref('studyGroups/' + groupId);
            
            groupRef.once('value').then((snapshot) => {
                const group = snapshot.val();
                
                // Make sure members is an array
                const members = Array.isArray(group.members) ? [...group.members] : [];
                
                // Filter out current user
                const updatedMembers = members.filter(member => member !== currentUser.uid);
                
                const updates = {};
                updates['/members'] = updatedMembers;
                updates['/memberCount'] = Math.max(0, (group.memberCount || 0) - 1);
                
                groupRef.update(updates).then(() => {
                    showToast('success', 'Left Group', 'You have successfully left the study group.');
                }).catch((error) => {
                    console.error("Error leaving study group:", error);
                    showToast('error', 'Error', 'Failed to leave study group.');
                });
            }).catch((error) => {
                console.error("Error getting study group:", error);
                showToast('error', 'Error', 'Failed to leave study group.');
            });
        }
        
        // Load comments
        function loadComments() {
            const container = document.getElementById('commentsContainer');
            container.innerHTML = '<div class="spinner"></div>';
            
            const commentsRef = database.ref('comments');
            
            commentsRef.orderByChild('createdAt').on('value', (snapshot) => {
                container.innerHTML = '';
                
                if (!snapshot.exists()) {
                    container.innerHTML = '<p class="text-gray-500 text-center">No comments yet. Be the first to comment!</p>';
                    return;
                }
                
                const commentsArray = [];
                snapshot.forEach((childSnapshot) => {
                    commentsArray.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                
                // Sort by creation date (newest first)
                commentsArray.sort((a, b) => {
                    return new Date(b.createdAt) - new Date(a.createdAt);
                });
                
                commentsArray.forEach(comment => {
                    const commentDiv = createCommentElement(comment);
                    container.appendChild(commentDiv);
                });
            }, (error) => {
                console.error("Error loading comments:", error);
                container.innerHTML = '<p class="text-gray-500 text-center">Error loading comments.</p>';
            });
        }
        
        // Create comment element
        function createCommentElement(comment) {
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            
            const date = comment.createdAt ? new Date(comment.createdAt).toLocaleDateString() : 'Unknown date';
            
            commentDiv.innerHTML = `
                <div class="comment-author">${comment.authorName || 'Anonymous'}</div>
                <div class="text-xs text-gray-500 mb-1">${date}</div>
                <div class="comment-text">${comment.text}</div>
            `;
            
            return commentDiv;
        }
        
        // Add comment
        function addComment() {
            if (!currentUser) {
                showToast('error', 'Sign in required', 'Please sign in to post comments.');
                return;
            }
            
            const commentInput = document.getElementById('commentInput');
            const commentText = commentInput.value.trim();
            
            if (!commentText) {
                showToast('error', 'Empty Comment', 'Please enter a comment before posting.');
                return;
            }
            
            showLoading();
            
            const commentsRef = database.ref('comments').push();
            
            commentsRef.set({
                authorId: currentUser.uid,
                authorName: userData.displayName,
                text: commentText,
                createdAt: firebase.database.ServerValue.TIMESTAMP
            }).then(() => {
                commentInput.value = '';
                showToast('success', 'Comment Posted', 'Your comment has been posted successfully.');
                
                // Award points
                awardPoints(5, 'Comment posted');
            }).catch((error) => {
                console.error("Error adding comment:", error);
                showToast('error', 'Error', 'Failed to post comment.');
            }).finally(() => {
                hideLoading();
            });
        }
        
        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        // Modal functions
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }
        
        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
        }
        
        function showCreateStudyGroup() {
            document.getElementById('createStudyGroupModal').classList.add('active');
        }
        
        function closeCreateStudyGroup() {
            document.getElementById('createStudyGroupModal').classList.remove('active');
        }
        
        // Authentication functions
        function signInWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            
            auth.signInWithPopup(provider)
                .then((result) => {
                    const user = result.user;
                    console.log("Google sign in successful:", user.uid);
                    showToast('success', 'Welcome!', 'You have been successfully signed in with Google.');
                    closeLoginModal();
                    // Set flag to indicate user just signed in
                    justSignedIn = true;
                    // The onAuthStateChanged listener will handle showing the pre-quiz introduction
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Google sign in error:", errorCode, errorMessage);
                    
                    if (errorCode === 'auth/unauthorized-domain') {
                        showToast('error', 'Domain not authorized', 
                            'Please add your GitHub Pages domain to the authorized domains in your Firebase project settings.');
                    } else {
                        showToast('error', 'Sign in failed', errorMessage);
                    }
                });
        }
        
        function signOut() {
            auth.signOut().then(() => {
                showToast('success', 'Signed out', 'You have been successfully signed out.');
                document.getElementById('landingPage').style.display = 'flex';
                document.getElementById('prequizPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'none';
            }).catch((error) => {
                console.error("Error signing out:", error);
            });
        }
        
        // Utility functions
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }
        
        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
        
        // Toast notification
        function showToast(type, title, message) {
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'fa-info-circle';
            if (type === 'success') icon = 'fa-check-circle';
            else if (type === 'error') icon = 'fa-exclamation-circle';
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="toast-message">
                    <div class="toast-title">${title}</div>
                    <div class="toast-description">${message}</div>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Hide toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>



